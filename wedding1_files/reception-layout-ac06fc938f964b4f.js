(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8042],{88704:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[weddingGuid]/supplies/reception-layout",function(){return c(27380)}])},85235:function(a,b,c){"use strict";c.r(b),c.d(b,{pushToasts:function(){return g},getLayout:function(){return h},importLayoutInstant:function(){return i},updateLayout:function(){return j},updateLayoutInstant:function(){return k},addTableInstant:function(){return l},addElementInstant:function(){return m},updateTableInstant:function(){return n},updateElementInstant:function(){return o},pushToFrontElementInstant:function(){return p},pushToBackElementInstant:function(){return q},deleteTableInstant:function(){return r},deleteElementInstant:function(){return s},takeASeatInstant:function(){return t},releaseSeatInstant:function(){return u},releaseSeatByGuestIdInstant:function(){return v},releaseAllSeatsInstant:function(){return w},getPdf:function(){return x},getPdfNew:function(){return y}});var d=c(32564),e=c(88086),f=c(27832);function g(a,b){a({type:e.I,payload:f.c.errorsForNotifications(f.c.extractErrors(b))})}function h(a,b,c){return function(e){e({type:d.fD,payload:null}),f.c.apiCall("GET","".concat("https://planning.wedding","/api/v1/project/layout-reception/").concat(a),b,function(a){!0===a.success?(e({type:d.fD,payload:a.item}),c&&c()):g(e,a.errors)})}}function i(a){return{type:d.QR,payload:a}}function j(a,b,c,e){var h=void 0!==e&&e;return function(e){f.c.apiCall("PUT","".concat("https://planning.wedding","/api/v1/project/layout-reception/").concat(a),b,function(a){!0===a.success?(h||e({type:d.vD,payload:a.item}),c&&c()):g(e,a.errors)})}}function k(a){return{type:d.vD,payload:a}}function l(a){return{type:d.vz,payload:a}}function m(a){return{type:d.oL,payload:a}}function n(a){return{type:d.w9,payload:a}}function o(a){return{type:d.S6,payload:a}}function p(a){return{type:d.WV,payload:a}}function q(a){return{type:d.cj,payload:a}}function r(a){return{type:d.B1,payload:a}}function s(a){return{type:d.Zu,payload:a}}function t(a){return{type:d.Fb,payload:a}}function u(a){return{type:d.y7,payload:a}}function v(a){return{type:d.t$,payload:a}}function w(a){return{type:d.sd,payload:a}}function x(a,b,c){return function(d){f.c.getFile("POST","".concat("https://planning.wedding","/api/v1/export/project/").concat(a,"/layout-reception"),b,function(a){c&&c()},function(){c&&c()},b&&b.filename?b.filename:"reception-layout.pdf")}}function y(a,b,c){return function(d){f.c.getFile("POST","".concat("https://planning.wedding","/api/v1/export/project/").concat(a,"/layout-reception/new"),b,function(a){c&&c()},function(){c&&c()},b&&b.filename?b.filename:"reception-layout.pdf")}}},27380:function(a,b,c){"use strict";c.r(b),c.d(b,{"__N_SSP":function(){return ra},"default":function(){return sa}});var d,e=c(35666),f=c.n(e),g=c(85893),h=c(67294),i=c(11163),j=c(70457),k=c(27208),l=c(14890),m=c(66338),n=c(82241),o=c(59717),p=c(21368),q=c(85235),r=c(71404),s=c(73572),t=c(30834),u=c(47162),v=c(65732),w=c(84498),x=c(33898),y=c(49860),z=c(75887),A=c(20569),B=c(68110),C=c(29801),D=c(99185),E=c(35196),F=c(5582),G=c.n(F),H=c(8580),I=c(54691),J=c(66912),K=c(51523),L=c(32719),M=c(34456),N=c(89937),O=c(4635),P=c(89782),Q=c(43834),R=c(66350),S=(0,h.forwardRef)(function(a,b){var c,d,e,f,i,j,k=function(a,b){return(0,g.jsx)(R.Z,{data:a,namingOfGuests:q,personType:r,selected:!1,done:!0,cacheWhoIsSeat:m,styles:p,baseFont:s,isCateringMode:void 0===b||b,handleSelectElement:function(){},handleUpdate:function(){},handleTakeASeat:function(){},handleHintShow:function(){},handleHintPosition:function(){},handleHintHide:function(){}},a.guid+"_places")},l=function(a){var b,c,d,e;switch(a.type){case"rectangle":return b=a,(0,g.jsx)(N.Z,{data:b,selected:null,done:!0,styles:p,isSafari:!1,baseFont:s,handleSelectElement:function(){},handleUpdate:function(){},handleTakeASeat:function(){},handleGetAvailablePlace:function(){}},b.guid);case"round":return c=a,(0,g.jsx)(O.Z,{data:c,selected:null,done:!0,styles:p,isSafari:!1,baseFont:s,handleSelectElement:function(){},handleUpdate:function(){},handleTakeASeat:function(){},handleGetAvailablePlace:function(){}},c.guid);case"half-round":return d=a,(0,g.jsx)(P.Z,{data:d,selected:null,done:!0,styles:p,isSafari:!1,baseFont:s,handleSelectElement:function(){},handleUpdate:function(){},handleTakeASeat:function(){},handleGetAvailablePlace:function(){}},d.guid);case"chairs":return e=a,(0,g.jsx)(Q.Z,{data:e,selected:null,done:!0,styles:p,isSafari:!1,baseFont:s,handleSelectElement:function(){},handleUpdate:function(){},handleTakeASeat:function(){},handleGetAvailablePlace:function(){}},e.guid);default:return null}},m=a.cacheWhoIsSeat,n=a.layout,o=a.table,p=a.printStyles,q=n.naming_of_guests,r=n.person_type,s=n.paragraph_font,t=(0,h.useState)(0),u=t[0],v=t[1],w=(0,h.useRef)(),x=(0,h.useRef)(),y=(d=(c=x&&x.current?x.current.getBBox():{height:0,width:0,x:0,y:0}).width,e=c.height,e+=60,f=(d+=60)/2,i=e/2+20,j=i+e+80,{shift1X:f,shift1Y:i,shift2X:f,shift2Y:j,svgWidth:d+20,svgHeight:j+e/2+80,tableWidth:d,tableHeight:e}),z=y.shift1X,A=y.shift1Y,B=y.shift2X,C=y.shift2Y,D=y.svgWidth,E=y.svgHeight;return y.tableWidth,y.tableHeight,(0,h.useImperativeHandle)(b,function(){return{extract:function(){return{table_guid:o.guid,svg:w.current.outerHTML}}}}),(0,h.useEffect)(function(){u<=3&&v(u+1)},[u]),(0,g.jsxs)("svg",{width:D,height:E,viewBox:"0 0 ".concat(D," ").concat(E),version:"1.1",xmlns:"http://www.w3.org/2000/svg",xmlnsXlink:"http://www.w3.org/1999/xlink",ref:w,children:[(0,g.jsx)("defs",{children:(0,g.jsx)("marker",{id:"arrow",viewBox:"0 -5 10 10",refX:"5",refY:"0",markerWidth:"4",markerHeight:"4",orient:"auto",children:(0,g.jsx)("path",{d:"M0,-5L10,0L0,5"})})}),(0,g.jsxs)("g",{transform:"translate(".concat(10," ",10,")"),children:[(0,g.jsx)("g",{ref:x,children:(0,g.jsxs)("g",{transform:"translate(".concat(z," ").concat(A,")"),children:[l(o),k(o,!1)]})}),(0,g.jsx)("g",{transform:"translate(".concat(B," ").concat(C-A-15,") rotate(180)"),children:(0,g.jsx)("line",{x1:"0",y1:"0",x2:"0",y2:"30",stroke:"#000",strokeWidth:"4",markerEnd:"url(#arrow)"})}),(0,g.jsxs)("g",{transform:"translate(".concat(B," ").concat(C,")"),children:[l(o),k(o,!0)]})]})]})}),T=c(97972);function U(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function V(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{},d=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(d=d.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),d.forEach(function(b){U(a,b,c[b])})}return a}var W=(0,h.forwardRef)(function(a,b){var c=a.layout,d=a.guestsCached,e=c.tables,f=c.places,i={};f&&Array.isArray(f)&&f.forEach(function(a){var b=a.guest_guid,c=a.place_guid;d[b]&&(i[c]=V({},a,d[b]))});var j=(0,h.useRef)([]);return(0,h.useImperativeHandle)(b,function(){return{extract:function(){return console.log(j.current),j.current.map(function(a){return a.extract()})}}}),(0,h.useEffect)(function(){j.current=j.current.slice(0,e.length)},[e]),e.map(function(a,b){var d=V({},a,{x:0,y:0});return(0,g.jsx)(S,{cacheWhoIsSeat:i,table:d,layout:c,printStyles:T.t,ref:function(a){return j.current[b]=a}},b)})});function X(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function Y(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{},d=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(d=d.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),d.forEach(function(b){X(a,b,c[b])})}return a}var Z=null,$=null,_=(0,h.forwardRef)(function(a,b){var c,d,e,f,i,j,k,l,m,n,o,p,q,r=function(a){for(var b=v.elements,c=v.places,d=b.reduce(function(a,b){return b.type.endsWith("-sign")&&(a[b.type]=!0),a},{}),e=Object.keys(d),f=0;f<e.length;f++)if(!L.G.checkLoadedAsset(e[f]))return!1;if(void 0!==a&&a){if(0===c.length)return!0;var g=c.reduce(function(a,b){return z[b.guest_guid]&&z[b.guest_guid].meal_icon&&(a[z[b.guest_guid].meal_icon]=!0),a},{});g.plate=!0;for(var h=Object.keys(g),i=0;i<h.length;i++)if(!M.L.checkLoadedAsset(h[i]))return!1}return!0},s=function(a){Z=a,G({}),D(1)},t=function(a,b){return"A1_portrait"===a?{width:900,height:parseInt(900*b.A1,10)}:{width:parseInt(900*b.A1,10),height:900}},u=function(a){var b=t(v.format,A),c=b.width,d=b.height;return a.outerHTML.replace(/width=(\S*)/,"width=\"".concat(1*c,"\"")).replace(/height=(\S*)/,"height=\"".concat(1*d,"\""))},v=a.layout,y=a.mesure,z=a.guestsCached,A=(0,h.useState)(function(){return{A1:1.4142}})[0],B=(0,h.useState)(0),C=B[0],D=B[1],E=(0,h.useState)({}),F=E[0],G=E[1],I=(0,h.useRef)(),J=(0,h.useRef)(),K=(0,h.useCallback)(function(a){var b=v.is_export_each_table;null!==a&&(1===C?$=setInterval(function(){r(!1)&&(clearInterval($),G(Y({},F,{seated:u(a.svgCanvas)})),D(2))},30):2===C?$=setInterval(function(){r(!0)&&(clearInterval($),G(Y({},F,{catering:u(a.svgCanvas)})),D(3))},30):3===C&&setTimeout(function(){G(Y({},F,{empty:u(a.svgCanvas)})),b?D(4):D(5)},30),4===C&&setTimeout(function(){G(Y({},F,{each_table:J.current.extract()})),D(5)},30))},[C]);return(0,h.useEffect)(function(){5===C&&(Z&&Z(F),D(0))},[C]),(0,h.useImperativeHandle)(b,function(){return{start:s}}),C?(c=v.is_export_each_table,(0,g.jsxs)("div",{style:{height:0,overflow:"hidden"},children:[(e=C,f=v.format,i=v.headline,j=v.headline_font,k=v.paragraph,l=v.paragraph_font,m=v.padding,n=t(f,A),o=n.width,p=n.height,q=0,i.trim()&&(q+=110),k.trim()&&(q+=i.trim()?45:110),setTimeout(function(){I&&I.current&&I.current.trimContent(m,q,n)},10),(0,g.jsx)(w.Z,{width:o,height:p,headline:i,headlineFont:j,headlineFontSize:40,paragraph:k,paragraphFont:l,paragraphFontSize:30,ref:K,children:(0,g.jsx)(x.Z,{done:!0,layout:v,selected:{},guestsCached:z,isGuestsHidden:3===e,isSafari:"safari"===(0,H.Z)().name,baseFont:l,mesure:y,isCateringMode:2===e,handleHintShow:function(){},handleHintPosition:function(){},handleHintHide:function(){},handleUpdateField:function(){},handleUpdateTable:function(){},handleSelectElement:function(){},handleUnselectElement:function(){},ref:I})})),c?(d=v,(0,g.jsx)(W,{layout:d,guestsCached:z,ref:J})):null]})):null}),aa=c(20350);function ba(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}var ca=(0,h.forwardRef)(function(a,b){var c=function(){d()},d=function(){k(!j)},e=a.t,f=a.handleUpdate,i=(0,h.useState)(!1),j=i[0],k=i[1];return((0,h.useImperativeHandle)(b,function(){return{show:c}}),j)?(0,g.jsxs)(v.Vq,{isOpen:j,onClose:d,className:"app__settings-dialog",children:[(0,g.jsxs)("div",{className:"bp3-dialog-header",children:[(0,g.jsx)("h4",{className:"bp3-heading",children:e("export_settings")}),(0,g.jsx)("button",{onClick:d,className:"bp3-button bp3-minimal bp3-icon-cross"})]}),(0,g.jsx)("div",{className:"bp3-dialog-body bootstrap-wrapper",children:(0,g.jsxs)("div",{children:[(0,g.jsx)("p",{className:"wa-p text-center",children:e("export_choose_note")}),function(){var b=a.layout,c=b.is_export_summary,d=b.is_export_seated_layout,h=b.is_export_catering_layout,i=b.is_export_empty_layout,j=b.is_export_each_table,k=b.is_export_guestlist_seated,l=b.is_export_dietary,m=b.is_export_guestlist_confirmed,n=[{title:e("export_summary"),key:"is_export_summary",value:c},{title:e("export_seated_layout"),key:"is_export_seated_layout",value:d},{title:e("export_catering_layout"),key:"is_export_catering_layout",value:h},{title:e("export_empty_layout"),key:"is_export_empty_layout",value:i},{title:e("export_each_table"),key:"is_export_each_table",value:j},{title:e("export_guestlist_seated"),key:"is_export_guestlist_seated",value:k},{title:e("export_dietary"),key:"is_export_dietary",value:l},{title:e("export_guestlist_confirmed"),key:"is_export_guestlist_confirmed",value:m},];return n.map(function(a,b){var c=a.title,d=a.key,e=a.value;return(0,g.jsx)("div",{style:function(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{},d=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(d=d.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),d.forEach(function(b){ba(a,b,c[b])})}return a}({padding:10},0===b?{paddingTop:22}:{}),children:(0,g.jsxs)("label",{className:"bp3-control bp3-switch",children:[(0,g.jsx)("input",{type:"checkbox",checked:!!e,onChange:function(a){return f(d,a.target.checked)}}),(0,g.jsx)("span",{className:"bp3-control-indicator"}),c]})},b)})}()]})})]}):null}),da=c(53766),ea=function(a){var b,c,d,e,f,i,j,k,l,m=a.t,n=a.tLayoutHTML,o=a.guests,p=a.layout,q=o.list,r=p.places,s=(0,h.useState)({seatedButNotConfirmedArr:[],seatedButNotConfirmed:0,confirmedButNotSeatedArr:[],confirmedButNotSeated:0,activeGuets:0}),t=s[0],u=s[1];(0,h.useEffect)(function(){var a,b,c=r.reduce(function(a,b){return a[b.guest_guid]=!0,a},{});u((a=q,b=c,a.reduce(function(a,c){return!c.static&&c.name&&(b[c.guid]||1!==c.status&&5!==c.status||(a.confirmedButNotSeated+=1,a.confirmedButNotSeatedArr.push(c)),b[c.guid]&&1!==c.status&&5!==c.status&&(a.seatedButNotConfirmed+=1,a.seatedButNotConfirmedArr.push(c)),""!==c.name.trim()&&(a.activeGuets+=1)),a},{seatedButNotConfirmedArr:[],seatedButNotConfirmed:0,confirmedButNotSeatedArr:[],confirmedButNotSeated:0,activeGuets:0})))},[q,r]);var w=t.confirmedButNotSeated,x=t.seatedButNotConfirmed,y=t.activeGuets;return y<=6?null:w||x?(k=(j=t).confirmedButNotSeated,l=j.seatedButNotConfirmed,(0,g.jsx)("div",{style:{paddingLeft:15,paddingRight:15},children:(0,g.jsxs)("div",{className:"app__block-note",children:[(0,g.jsx)("p",{className:"wa-p",children:(0,g.jsx)("b",{children:m("summary_note")})}),k?(b=t.confirmedButNotSeated,c=t.confirmedButNotSeatedArr.map(function(a){return a.name}).join(", "),d=(0,g.jsx)(v.u,{content:(0,g.jsx)("div",{style:{maxWidth:300},children:c}),position:da.Ly.BOTTOM,children:(0,g.jsxs)("span",{className:"psedo-link",children:[b," ",m(1===b?"guest":"guests")]})}),(0,g.jsxs)("p",{className:"wa-p",children:[m("summary_found")," — ",(0,g.jsx)("b",{children:d})," ",n("summary_confirmed")]})):null,l?(e=t.seatedButNotConfirmed,f=t.seatedButNotConfirmedArr.map(function(a){return a.name}).join(", "),i=(0,g.jsx)(v.u,{content:(0,g.jsx)("div",{style:{maxWidth:300},children:f}),position:da.Ly.BOTTOM,children:(0,g.jsxs)("span",{className:"psedo-link",children:[e," ",m(1===e?"guest":"guests")]})}),(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)("p",{className:"wa-p",children:[(0,g.jsx)("b",{children:i})," — ",n("summary_not_confirmed")]}),(0,g.jsx)("p",{className:"wa-p",children:n("summary_action")})]})):null]})})):r&&0===r.length?null:(0,g.jsx)("h3",{className:"guests__wedding-party",style:{paddingLeft:10,paddingRight:10,marginTop:-15},children:m("summary_all_seated")})},fa=c(47609),ga=c(91620);function ha(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(j){c(j);return}h.done?b(i):Promise.resolve(i).then(d,e)}function ia(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}var ja=J.S.extract("templates/app").t,ka=J.S.extract("project/layout"),la=ka.t,ma=ka.tHTML,na=J.S.extract("project/supplies").t,oa=J.S.extract("project/guest-list").t,pa=J.S.extract("").t,qa={},ra=!0,sa=(0,m.$j)(function(a){return{init:a.init,user:a.user,wedding:a.wedding,guests:a.guests,layout:a.layoutReception}},function(a){return{initActions:(0,l.DE)(n,a),weddingActions:(0,l.DE)(o,a),guestsActions:(0,l.DE)(p,a),layoutActions:(0,l.DE)(q,a)}})((0,u.Z)(function(a){var b,c,e,l,m,n,o,p,q,u,F,L,M,N,O,P,Q,R,S,T,U,V,W,X,Y,Z,$,ba,da,ka,ra=function(){var a=Pa.createGuestInstant,b=Pa.createGuestsBatchInstant,c=Pa.updateGuestInstant,e=Pa.deleteGuestInstant,f=Pa.deleteAllGuestsInstant,g=Pa.setCustomInputFieldsInstant,h=Pa.updateCustomInputFieldInstant,i=Pa.deleteCustomInputFieldInstant,j=Pa.updateAttributesInstant,k=Pa.addFamilyInstant,l=Pa.updateFamilyInstant,m=Pa.deleteFamilyInstant,n=Pa.addMealInstant,o=Pa.updateMealInstant,p=Pa.updateMealsOrderInstant,q=Pa.deleteMealInstant,r=Qa.addTableInstant,s=Qa.addElementInstant,t=Qa.updateTableInstant,u=Qa.updateElementInstant,v=Qa.pushToFrontElementInstant,w=Qa.pushToBackElementInstant,x=Qa.deleteTableInstant,y=Qa.deleteElementInstant,z=Qa.takeASeatInstant,A=Qa.releaseSeatInstant,B=Qa.releaseSeatByGuestIdInstant,C=Qa.releaseAllSeatsInstant,D=Qa.updateLayoutInstant,E=(ia(d={createGuestInstant:a,createGuestsBatchInstant:b,updateGuestInstant:c,deleteGuestInstant:e,deleteAllGuestsInstant:f,setCustomInputFieldsInstant:g,updateCustomInputFieldInstant:h,deleteCustomInputFieldInstant:i,updateAttributesInstant:j,addFamilyInstant:k,updateFamilyInstant:l,deleteFamilyInstant:m,addMealInstant:n,updateMealInstant:o,updateMealsOrderInstant:p,deleteMealInstant:q},mb+"addTableInstant",r),ia(d,mb+"addElementInstant",s),ia(d,mb+"updateTableInstant",t),ia(d,mb+"updateElementInstant",u),ia(d,mb+"pushToFrontElementInstant",v),ia(d,mb+"pushToBackElementInstant",w),ia(d,mb+"deleteTableInstant",x),ia(d,mb+"deleteElementInstant",y),ia(d,mb+"takeASeatInstant",z),ia(d,mb+"releaseSeatInstant",A),ia(d,mb+"releaseSeatByGuestIdInstant",B),ia(d,mb+"releaseAllSeatsInstant",C),ia(d,mb+"updateLayoutInstant",D),d);Ia.setCallBackEvents(E)},sa=function(a,b,c){if("full"!==Ka.access)return null;var d=ia({},a,b);Qa.updateLayoutInstant(d),clearInterval(qa[a]),qa[a]=setTimeout(function(){return Qa.updateLayout(Aa,d,null,!0)},void 0!==c&&c?0:lb),Ia.send({action:mb+"updateLayoutInstant",payload:d})},ta=function(){if(jb){document.dispatchEvent(new MouseEvent("notSupportedDialog"));return}Fa&&Fa.current&&(Fa.current.ref.current.show(),ua(!1))},ua=function(a){Wa(a),Za(null),ab(null)},va=function(a,b){sa(a,b,!0)},wa=function(a,b){if(Number.isInteger(b)){var c=Array.from(Ma.padding);c[a]=b,sa("padding",c)}},xa=function(a,b,c){var d=a&&b?"".concat(a.replace(/ /g,"_"),"_&_").concat(b.replace(/ /g,"_"),"_"):"";return"".concat(d,"reception-layout_").concat(G()().format("DD-MMMM-YYYY"),".").concat(c)},ya=(0,i.useRouter)(),za=ya.locale,Aa=ya.query.weddingGuid,Ba=(0,h.useRef)(null);za!==Ba.current&&(J.S.load(za,a.dict),Ba.current=za);var Ca=(0,h.useRef)(),Da=(0,h.useRef)(),Ea=(0,h.useRef)(),Fa=(0,h.useRef)(),Ga=(0,h.useRef)(),Ha=(0,h.useRef)(),Ia=(Ca&&Ca.current?Ca.current:{}).socket,Ja=a.init,Ka=a.wedding,La=a.guests,Ma=a.layout,Na=a.initActions,Oa=a.weddingActions,Pa=a.guestsActions,Qa=a.layoutActions,Ra=(0,h.useState)(0),Sa=Ra[0],Ta=Ra[1],Ua=(0,h.useState)(!0),Va=Ua[0],Wa=Ua[1],Xa=(0,h.useState)(null),Ya=Xa[0],Za=Xa[1],$a=(0,h.useState)(null),_a=$a[0],ab=$a[1],bb=(0,h.useState)({}),cb=bb[0],db=bb[1],eb=(0,h.useState)(!1),fb=eb[0];eb[1];var gb=(0,h.useState)(!1),hb=gb[0],ib=gb[1],jb=(0,h.useState)(function(){return D.i.is()})[0],kb=(0,h.useState)({A1:1.4142})[0],lb=(0,h.useState)(300)[0],mb=(0,h.useState)("RE")[0];function nb(a){return ob.apply(this,arguments)}function ob(){return(ob=(function(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var f=a.apply(b,c);function g(a){ha(f,d,e,g,h,"next",a)}function h(a){ha(f,d,e,g,h,"throw",a)}g(void 0)})}})(f().mark(function b(c){var d,e,g;return f().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return d=fa.a.get(),b.next=3,Oa.checkIsPremiumRequired(Aa,{wli:a.user.wli,source:d&&d.source});case 3:if(!(e=b.sent)){b.next=8;break}return document.dispatchEvent(new MouseEvent("premiumDialog")),c&&c(),b.abrupt("return",null);case 8:Ga&&Ga.current&&(g=function(b){var d=Ma.format,e=Ka.bride,f=Ka.groom;console.log("CALL"),Qa.getPdfNew(Aa,{wli:a.user.wli,svg_assets:b,format:d,filename:xa(f,e,"pdf")},c),r.B({category:"Project",action:"project-export-layout-reception-pdf",label:"Project Export Layout Reception Pdf"}),Ka.is_premium?r.B({category:"Project",action:"project-export-layout-pdf__premium",label:"Project Export Layout Pdf Premium"}):r.B({category:"Project",action:"project-export-layout-pdf__not-premium",label:"Project Export Layout Pdf Not Premium"})},Ga.current.start(g));case 9:case"end":return b.stop()}},b)}))).apply(this,arguments)}return(0,j.C)(function(){Aa&&"[weddingGuid]"!==Aa&&(Pa.getGuests(Aa),Qa.getLayout(Aa),Ja.is_fonts_loaded||C.F.loadAll(function(){setTimeout(function(){return Ta(function(a){return a+1})},150),Ta(function(a){return a+1}),Na.setFontLoaded(!0)}),setTimeout(function(){return Ta(function(a){return a+1})},100))},[Aa]),(0,k.D)(function(){Ta(Sa+1)},[za]),(0,h.useEffect)(function(){return Ia&&ra(Ia),function(){Ia&&Ia.setCallBackEvents({})}},[Ia]),(0,h.useEffect)(function(){if(La.list){var a={};La.meals&&La.meals.forEach(function(b){a[b._id]=b});var b={};La.list&&La.list.forEach(function(c){var d=function(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{},d=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(d=d.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),d.forEach(function(b){ia(a,b,c[b])})}return a}({},c);c.meal_id&&a[c.meal_id]&&(d.meal_icon=a[c.meal_id].icon),b[c.guid]=d}),db(b)}},[La.list,La.meals]),(0,g.jsxs)(s.Z,{ref:Ca,children:[(ka=(0,E.R)("/project/".concat(Aa,"/supplies/reception-layout"),za),(0,g.jsx)(t.Z,{router:ya,title:la("h2"),description:la("p"),alternate:"all",disableIndexing:"none",canonical:ka,schemaLogo:JSON.stringify([ga.c.generate(za)])})),(0,g.jsxs)("main",{children:[(0,g.jsx)(I.Z,{tSupplies:na,weddingGuid:Aa,router:ya,hiddenServices:Ka.hidden_services}),(0,g.jsx)("h2",{className:"wa-h2",children:la("h2")}),(0,g.jsx)("p",{className:"wa-p text-center",children:la("p")}),Ka._id&&La.list&&Ma.isLoaded?(0,g.jsxs)(g.Fragment,{children:[La.meals&&La.meals.length?(0,g.jsx)("div",{style:{display:"flex",justifyContent:"center",marginTop:10,marginBottom:-10},children:(0,g.jsx)(K.Z,{list:[{key:"seating",title:la("seating_mode")},{key:"catering",title:la("catering_mode")},],value:hb?"catering":"seating",handleChange:function(a){return ib("catering"===a)}})}):null,jb?(0,g.jsx)("div",{className:"text-center",children:(0,g.jsx)("span",{className:"table-cards__h3 psedo-link",onClick:ta,children:ja("edit_layout_link")})}):null,(0,g.jsx)("div",{className:"A1_landscape"===Ma.format?"layout__preview-A1-portrait":"layout__preview-A1-landscape",children:(0,g.jsxs)("div",{className:"layout__edit-link layout__edit-link_shadow layout__edit-link_paper",onClick:ta,children:[Va?(m=Ma.format,n=Ma.headline,o=Ma.headline_font,p=Ma.paragraph,q=Ma.paragraph_font,u=Ma.padding,e=m,l=kb,F="A1_portrait"===e?{width:900,height:parseInt(900*l.A1,10)}:{width:parseInt(900*l.A1,10),height:900},L=F.width,M=F.height,N=0,n.trim()&&(N+=110),p.trim()&&(N+=n.trim()?45:110),setTimeout(function(){Da&&Da.current&&Da.current.trimContent(u,N,F)},10),O=(0,g.jsx)(x.Z,{done:!0,layout:Ma,selected:{},guestsCached:cb,isGuestsHidden:fb,isSafari:"safari"===(0,H.Z)().name,baseFont:q,mesure:Ka.mesure,isCateringMode:hb,handleHintShow:function(a,b,c){var d={0:pa("not_set"),1:pa("confirmed_both"),2:pa("pending"),3:pa("canceled"),4:pa("confirmed_ceremony"),5:pa("confirmed_reception")},e=c.rank,f=c.name,h=c.status,i=c.side,j=c.restrictions;ab((0,g.jsxs)("div",{children:[(0,g.jsx)("div",{className:"layout__hint-side",children:"bride"===i?la("l_bride"):la("l_groom")}),e?e+" ":null,f,(0,g.jsxs)("div",{className:"layout__hint-rsvp",children:[la("l_rsvp")," - ",d[h]?d[h]:""]}),j?(0,g.jsxs)("div",{className:"layout__hint-rsvp",style:{color:"#FE5C7D",fontWeight:"bold"},children:[la("export_dietary"),(0,g.jsx)("br",{}),j]}):null]})),Za({x:a+10,y:b-80})},handleHintPosition:function(a,b){Za({x:a+10,y:b-240})},handleHintHide:function(){Za(null),ab(null)},handleUpdateField:function(){},handleUpdateTable:function(){},handleSelectElement:function(){},handleUnselectElement:function(){},ref:Da}),(0,g.jsx)(w.Z,{width:L,height:M,headline:n,headlineFont:o,headlineFontSize:40,paragraph:p,paragraphFont:q,paragraphFontSize:30,ref:Ea,children:O})):null,(0,g.jsxs)("div",{className:"layout__edit-link-icon",children:[(0,g.jsx)("span",{className:"bp3-icon-standard bp3-icon-edit"})," ",la("edit_btn")]})]})}),(Q=Ma.person_type,R=Ma.format,S=Ma.headline,T=Ma.headline_font,U=Ma.paragraph,V=Ma.paragraph_font,W=Ma.padding,X=Ma.naming_of_guests,Y=function(a){if(Array.isArray(a))return a}(P=W)||function(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{d||null==h.return||h.return()}finally{if(e)throw f}}return c}(P,4)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}(),Z=Y[0],$=Y[1],ba=Y[2],da=Y[3],(0,g.jsxs)(g.Fragment,{children:[(0,g.jsx)(aa.Z,{title:la("customize_view"),children:(0,g.jsxs)(g.Fragment,{children:[(0,g.jsxs)("label",{className:"bp3-control bp3-radio ma-bottom-15",children:[(0,g.jsx)("input",{type:"radio",value:"color",checked:"color"===Q,name:"radio-kind",onChange:function(a){return sa("person_type",a.target.value,!0)}}),(0,g.jsx)("span",{className:"bp3-control-indicator"}),la("person_type_color")]}),(0,g.jsxs)("label",{className:"bp3-control bp3-radio",children:[(0,g.jsx)("input",{type:"radio",value:"generic",checked:"generic"===Q,name:"radio-kind",onChange:function(a){return sa("person_type",a.target.value,!0)}}),(0,g.jsx)("span",{className:"bp3-control-indicator"}),la("person_type_generic")]}),(0,g.jsx)("br",{}),(0,g.jsx)("div",{className:"bp3-select bp3-fill table-cards__settings-line",children:(0,g.jsxs)("select",{value:R||"",onChange:function(a){return sa("format",a.target.value,!0)},children:[(0,g.jsx)("option",{value:"A1_landscape",children:la("paper_a1_landscape")}),(0,g.jsx)("option",{value:"A1_portrait",children:la("paper_a1_portrait")})]})}),(0,g.jsx)("input",{className:"bp3-input bp3-fill",placeholder:la("heading_placeholder"),value:S,onChange:function(a){return sa("headline",a.target.value)}}),(0,g.jsx)("div",{className:"table-cards__settings-line",children:(0,g.jsx)(y.Z,{fontPrefix:la("font_prefix"),font:T,handleSetFont:function(a){return va("headline_font",a)}})}),(0,g.jsx)("input",{className:"bp3-input bp3-fill",placeholder:la("paragraph_placeholder"),value:U,onChange:function(a){return sa("paragraph",a.target.value)}}),(0,g.jsx)("div",{className:"table-cards__settings-line",children:(0,g.jsx)(y.Z,{fontPrefix:la("font_prefix"),font:V,handleSetFont:function(a){return va("paragraph_font",a)}})}),(0,g.jsx)("div",{className:"bp3-select bp3-fill",children:(0,g.jsxs)("select",{value:X,onChange:function(a){return sa("naming_of_guests",a.target.value,!0)},children:[(0,g.jsxs)("option",{value:"full_name",children:[la("naming")," — ",la("naming_full_name")]}),(0,g.jsxs)("option",{value:"only_first_name",children:[la("naming")," — ",la("naming_only_first_name")]}),(0,g.jsxs)("option",{value:"short_surname",children:[la("naming")," — ",la("naming_first_letter")]}),(0,g.jsxs)("option",{value:"automatic",children:[la("naming")," — ",la("naming_automatic")]})]})}),(0,g.jsxs)("div",{className:"table-cards__settings-line",children:[(0,g.jsx)("hr",{}),(0,g.jsx)("div",{className:"text-center",children:la("extra_margin")}),(0,g.jsxs)("div",{className:"table-cards__cross-control",children:[(0,g.jsx)("div",{className:"table-cards__cross-control-top",children:(0,g.jsx)("div",{className:"table-cards__cross-control-item",children:(0,g.jsx)(v.Af,{onValueChange:function(a){return wa(0,a)},value:Z,fill:!0,min:-500,max:500,placeholder:"top"})})}),(0,g.jsxs)("div",{className:"table-cards__cross-control-left",children:[(0,g.jsx)("div",{className:"table-cards__cross-control-item",children:(0,g.jsx)(v.Af,{onValueChange:function(a){return wa(3,a)},value:da,fill:!0,min:-500,max:500,placeholder:"left"})}),(0,g.jsx)("div",{className:"table-cards__cross-control-item",children:(0,g.jsx)(v.Af,{onValueChange:function(a){return wa(1,a)},value:$,fill:!0,min:-500,max:500,placeholder:"right"})})]}),(0,g.jsx)("div",{className:"table-cards__cross-control-top",children:(0,g.jsx)("div",{className:"table-cards__cross-control-item",children:(0,g.jsx)(v.Af,{onValueChange:function(a){return wa(2,a)},value:ba,fill:!0,min:-500,max:500,placeholder:"bottom"})})})]})]})]})}),(0,g.jsx)("br",{}),(0,g.jsx)("div",{className:"text-center",children:(0,g.jsx)("span",{className:"table-cards__h3 psedo-link",onClick:ta,children:ja("edit_layout_link")})}),(b=Ma.format,c=Ka.mesure,(0,g.jsx)("h3",{className:"table-cards__h3",style:{marginTop:10},onClick:ta,children:ja("inch"===c?"A1_landscape"===b?"format_a1_l_inch":"format_a1_p_inch":"A1_landscape"===b?"format_a1_l_cm":"format_a1_p_cm")})),Va?(0,g.jsx)(ea,{t:la,tLayoutHTML:ma,guests:La,layout:Ma}):null]})),"full"===Ka.access&&(0,g.jsx)(g.Fragment,{children:(0,g.jsxs)("div",{className:"app__container text-center",children:[(0,g.jsx)("button",{className:"bp3-button bp3-minimal bp3-icon-export wa-intent-purple",onClick:function(){Ha&&Ha.current&&Ha.current.show()},children:la("export_settings")}),(0,g.jsx)("br",{}),(0,g.jsx)("br",{}),(0,g.jsx)(A.Z,{title:ja("download_pdf_btn"),handleExport:nb}),(0,g.jsx)("br",{}),(0,g.jsx)("br",{}),(0,g.jsxs)("div",{className:"bp3-callout app__block-recommendation",children:[(0,g.jsx)("h4",{className:"bp3-heading",children:ja("print_recommend_h4")}),(0,g.jsx)("p",{children:ja("print_recommend_p")})]}),(0,g.jsx)("br",{}),(0,g.jsx)("br",{}),(0,g.jsx)("br",{})]})}),function(){if(!Ya)return null;var a=Ya.x,b=Ya.y;return(0,g.jsx)("div",{className:"layout__hint",style:{top:b,left:a},children:_a})}(),(0,g.jsx)(z.Z,{tApp:ja,intl:la,tBasic:pa,tGuestList:oa,locale:za,isAllowCateringMode:!0,isCateringMode:hb,handleSetIsCateringMode:function(a){return ib(a)},postfix:mb,socket:Ia,wedding:Ka,guestsCached:cb,guests:La,layout:Ma,handleExportPDF:nb,handleToggleVisibilityLayout:ua,handleWeddingActions:Oa,handleGuestsActions:Pa,handleLayoutActions:Qa,ref:Fa}),(0,g.jsx)(_,{layout:Ma,mesure:Ka.mesure,guestsCached:cb,ref:Ga}),(0,g.jsx)(ca,{t:la,layout:Ma,handleUpdate:sa,ref:Ha})]}):(0,g.jsx)(B.Z,{})]})]})}))}},function(a){a.O(0,[4885,630,4317,4116,5732,4734,6441,5162,3458,5506,3524,7868,7811,6120,5154,713,8173,3894,8262,1837,8470,6179,5083,42,1385,9631,7389,9997,9256,9774,2888,179],function(){return a(a.s=88704)}),_N_E=a.O()}])