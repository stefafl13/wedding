(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3612],{31529:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[weddingGuid]/notes",function(){return c(70567)}])},76443:function(a,b,c){"use strict";c.r(b),c.d(b,{pushToasts:function(){return g},getNotes:function(){return h},updateNotes:function(){return i},createPageInstant:function(){return j},updatePageInstant:function(){return k},deletePageInstant:function(){return l},getPdf:function(){return m}});var d=c(98843),e=c(88086),f=c(27832);function g(a,b){a({type:e.I,payload:f.c.errorsForNotifications(f.c.extractErrors(b))})}function h(a,b,c){return function(e){e({type:d.u1,payload:null}),f.c.apiCall("GET","".concat("https://planning.wedding","/api/v1/project/notes/").concat(a),b,function(a){!0===a.success?(e({type:d.u1,payload:a.item}),c&&c()):g(e,a.errors)})}}function i(a,b,c,e){var h=void 0!==e&&e;return function(e){f.c.apiCall("PUT","".concat("https://planning.wedding","/api/v1/project/notes/").concat(a),b,function(a){!0===a.success?(h||e({type:d.wi,payload:a.item}),c&&c()):g(e,a.errors)})}}function j(a){return{type:d.wY,payload:a}}function k(a){return{type:d.mB,payload:a}}function l(a){return{type:d.W_,payload:a}}function m(a,b,c){return function(d){f.c.getFile("POST","".concat("https://planning.wedding","/api/v1/export/project/").concat(a,"/notes/pdf"),b,function(a){c&&c()},function(){c&&c()},b&&b.filename?b.filename:"notes.pdf")}}},70567:function(a,b,c){"use strict";c.r(b),c.d(b,{"__N_SSP":function(){return J},"default":function(){return K}});var d=c(85893),e=c(67294),f=c(11163),g=c(70457),h=c(27208),i=c(14890),j=c(66338),k=c(59717),l=c(76443),m=c(71404),n=c(73572),o=c(30834),p=c(65732),q=c(53766);if("undefined"!=typeof document)var r=c(69748);var s=function(a){var b=function(a){k(j),h&&h(a,m)},c=a.className,f=a.options,g=a.text,h=a.onChange,i=(0,e.useState)(g),j=i[0],k=i[1],l=(0,e.useRef)(),m=(0,e.useRef)();return(0,e.useEffect)(function(){return m.current=new r(l.current,f),m.current.subscribe("editableInput",function(a){b(l.current.innerHTML)}),function(){m.current.destroy()}},[]),(0,e.useEffect)(function(){g!==l.current.innerHTML&&(l.current.innerHTML=g)},[g]),m&&m.current&&m.current.saveSelection(),(0,d.jsx)("div",{className:c||"",dangerouslySetInnerHTML:{__html:j},ref:l})};function t(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function u(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}function v(a){return(v=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}function w(a,b){return(w=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a})(a,b)}var x=function(a){"use strict";!function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&w(a,b)}(g,a);var b,c,e,f=function(a){var b=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}();return function(){var c,d,e,f,g=v(a);if(b){var h=v(this).constructor;f=Reflect.construct(g,arguments,h)}else f=g.apply(this,arguments);return d=this,(e=f)&&("object"==((c=e)&&"undefined"!=typeof Symbol&&c.constructor===Symbol?"symbol":typeof c)||"function"==typeof e)?e:t(d)}}(g);function g(){var a;return!function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(this,g),a=f.apply(this,arguments),!function(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}(t(a),"renderSettings",function(b){return(0,d.jsxs)(p.J2,{className:"notes__page-settings",interactionKind:p.V3.CLICK,popoverClassName:"bp3-popover-content-sizing",position:q.Ly.BOTTOM,children:[(0,d.jsx)("button",{className:"bp3-button bp3-icon-more bp3-minimal wa-intent-purple"}),(0,d.jsx)("div",{children:(0,d.jsx)("button",{className:"bp3-button bp3-icon-trash bp3-minimal bp3-popover-dismiss",onClick:function(){return a.props.handleRemovePage(b)},children:a.props.intl("remove_btn")})})]})}),a}return b=g,c=[{key:"shouldComponentUpdate",value:function(a){var b=this.props.data,c=b.id,d=b.content;return c===a.data.id||d!==a.data.content}},{key:"render",value:function(){var a=this,b=this.props.data,c=b.id,e=b.content;return(0,d.jsx)(d.Fragment,{children:(0,d.jsxs)("div",{className:"notes__page",children:[this.props.countOfPages>1?this.renderSettings(c):null,(0,d.jsx)(s,{text:e,className:"notes__area",onChange:function(b,d){return a.props.handleChange(c,b,d)},options:{autoLink:!0,imageDragging:!1,extensions:{imageDragging:{}},targetBlank:!0,toolbar:{buttons:["bold","italic","underline","anchor","h1","h2","justifyLeft","justifyCenter","justifyRight","removeFormat",]},paste:{forcePlainText:!0,cleanPastedHTML:!1,cleanReplacements:[],cleanAttrs:["class","style","dir"],cleanTags:["meta"],unwrapTags:[]},placeholder:{text:"",hideOnClick:!0},disableEditing:this.props.disableEditing}})]})})}}],u(b.prototype,c),e&&u(b,e),g}(e.Component),y=c(20569),z=c(68110),A=c(27832),B=c(35196),C=c(5582),D=c.n(C),E=c(66912),F=c(91620),G=E.S.extract("templates/app").t,H=E.S.extract("project/notes").t,I={},J=!0,K=(0,j.$j)(function(a){return{user:a.user,wedding:a.wedding,notes:a.notes}},function(a){return{weddingActions:(0,i.DE)(k,a),notesActions:(0,i.DE)(l,a)}})(function(a){var b=function(){var a=J.updatePageInstant,b=J.createPageInstant,c=J.deletePageInstant;v.setCallBackEvents({updatePageInstant:a,createPageInstant:b,deletePageInstant:c})},c=function(a,b,c){var d=a&&b?"".concat(a.replace(/ /g,"_"),"_&_").concat(b.replace(/ /g,"_"),"_"):"";return"".concat(d,"notes_").concat(D()().format("DD-MMMM-YYYY"),".").concat(c)},i=(0,f.useRouter)(),j=i.locale,k=i.query.weddingGuid,l=(0,e.useRef)(null);j!==l.current&&(E.S.load(j,a.dict),l.current=j);var p,q,r,s,t,u=(0,e.useRef)(),v=(u&&u.current?u.current:{}).socket,w=a.wedding,C=a.notes,J=a.notesActions,K=(0,e.useState)(0),L=K[0],M=K[1],N=(0,e.useState)(0),O=N[0],P=N[1],Q=(0,e.useState)(null),R=Q[0],S=Q[1];return(0,g.C)(function(){k&&"[weddingGuid]"!==k&&J.getNotes(k)},[k]),(0,h.D)(function(){M(L+1)},[j]),(0,e.useEffect)(function(){return v&&b(v),function(){v&&v.setCallBackEvents({})}},[v]),(0,e.useEffect)(function(){R&&(clearInterval(I),I=setTimeout(function(){C.list&&J.updateNotes(k,{list:C.list},null,!0)},500),S(!1))},[R]),(0,d.jsxs)(n.Z,{ref:u,children:[(p=(0,B.R)("/project/".concat(k,"/notes"),j),(0,d.jsx)(o.Z,{router:i,title:H("h2"),description:H("p"),alternate:"all",disableIndexing:"none",canonical:p,schemaLogo:JSON.stringify([F.c.generate(j)])})),(0,d.jsxs)("main",{className:"notes",children:[(0,d.jsx)("h1",{className:"wa-h2",children:H("h2")}),(0,d.jsx)("p",{className:"wa-p text-center",children:H("p")}),w._id&&C.list?(r=C.list,s=O,r&&Array.isArray(r)&&r[s]||(s=0),r&&Array.isArray(r)&&r[s]&&(q=(0,d.jsx)(x,{intl:H,data:r[s],countOfPages:r.length,handleChange:function(a,b){if("full"!==w.access)return null;var c={id:a,content:b};J.updatePageInstant(c),S(!0),v.send({action:"updatePageInstant",payload:c})},handleRemovePage:function(a){if("full"!==w.access)return null;J.deletePageInstant(a),clearInterval(I),I=setTimeout(function(){C.list&&J.updateNotes(k,{list:C.list},null,!0)},100),v.send({action:"deletePageInstant",payload:a})},disableEditing:"full"!==w.access},s)),(t=r&&Array.isArray(r)?r.map(function(a,b){var c=b;return(0,d.jsx)("div",{className:"notes__pagination-page"+(b===s?" notes__pagination-page_active":""),onClick:function(){return P(c)},children:c+1},b)}):[]).push((0,d.jsx)("button",{className:"bp3-button bp3-icon-add bp3-minimal wa-intent-purple",onClick:function(){if("full"!==w.access)return null;var a,b={id:A.c.guid(),page:C.list.length+1,content:""};J.createPageInstant(b),J.updateNotes(k,{list:((function(a){if(Array.isArray(a)){for(var b=0,c=new Array(a.length);b<a.length;b++)c[b]=a[b];return c}})(a=C.list)||(function(a){if(Symbol.iterator in Object(a)||"[object Arguments]"===Object.prototype.toString.call(a))return Array.from(a)})(a)||(function(){throw new TypeError("Invalid attempt to spread non-iterable instance")})()).concat([b])},null,!0),v.send({action:"createPageInstant",payload:b})},style:{marginBottom:10},children:H("add_new_page_btn")},"add")),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("br",{}),q,(0,d.jsx)("div",{className:"notes__pagination",children:t}),(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)("br",{}),(0,d.jsx)(y.Z,{title:G("download_pdf_btn"),handleExport:function(b){var d=w.guid,e=w.groom,f=w.bride,g={wli:a.user.wli,filename:c(e,f,"pdf")};J.getPdf(d,g,b),m.B({category:"Project",action:"project-export-notes-pdf",label:"Project Export Notes Pdf"})}})]})]})):(0,d.jsx)(z.Z,{})]})]})})},27208:function(a,b,c){"use strict";c.d(b,{D:function(){return e}});var d=c(67294);function e(a,b){var c=(0,d.useRef)(!1);(0,d.useEffect)(function(){c.current?a():c.current=!0},b)}}},function(a){a.O(0,[4885,1179,4317,4116,5732,4734,6441,5162,3458,5506,3524,7868,7811,6120,3894,8262,1837,8470,6179,5083,42,1385,9774,2888,179],function(){return a(a.s=31529)}),_N_E=a.O()}])