(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6052],{5593:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[weddingGuid]/checklist",function(){return c(76313)}])},79953:function(a,b,c){"use strict";c.r(b),c.d(b,{pushToasts:function(){return m},getChecklist:function(){return n},updateChecklist:function(){return o},changeOrderItemsTaskInstant:function(){return p},createTaskInstant:function(){return q},updateTaskInstant:function(){return r},deleteTaskInstant:function(){return s},createSubTaskInstant:function(){return t},updateSubTaskInstant:function(){return u},deleteSubTaskInstant:function(){return v},resetTasksInstant:function(){return w},replaceChecklist:function(){return x},replaceChecklistInstant:function(){return y},getPdf:function(){return z},getXls:function(){return A}});var d=c(35666),e=c.n(d),f=c(12753),g=c(88086),h=c(27832),i=c(31624);function j(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(j){c(j);return}h.done?b(i):Promise.resolve(i).then(d,e)}function k(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var f=a.apply(b,c);function g(a){j(f,d,e,g,h,"next",a)}function h(a){j(f,d,e,g,h,"throw",a)}g(void 0)})}}function l(a,b){return(function(a){if(Array.isArray(a))return a})(a)||(function(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{d||null==h.return||h.return()}finally{if(e)throw f}}return c})(a,b)||(function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")})()}function m(a,b){a({type:g.I,payload:i.V.errorsForNotifications(i.V.extractErrors(b))})}function n(a,b,c){return k(e().mark(function d(g){var h,j,k;return e().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return g({type:f.jo,payload:null}),d.t0=l,d.next=4,i.V.get("".concat("https://planning.wedding","/api/v1/project/").concat(a,"/checklist"),b);case 4:if(d.t1=d.sent,j=(h=(0,d.t0)(d.t1,2))[0],k=h[1],!j){d.next=11;break}return m(g,j.errors),d.abrupt("return");case 11:g({type:f.jo,payload:k.item}),c&&c();case 13:case"end":return d.stop()}},d)}))}function o(a,b,c,d){var g=void 0!==d&&d;return k(e().mark(function d(h){var j,k,n;return e().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.t0=l,d.next=3,i.V.put("".concat("https://planning.wedding","/api/v1/project/").concat(a,"/checklist"),b);case 3:if(d.t1=d.sent,k=(j=(0,d.t0)(d.t1,2))[0],n=j[1],!k){d.next=10;break}return m(h,k.errors),d.abrupt("return");case 10:g||h({type:f.jo,payload:n.item}),c&&c();case 12:case"end":return d.stop()}},d)}))}function p(a){return{type:f.VP,payload:a}}function q(a){return{type:f.F5,payload:a}}function r(a){return{type:f.Cu,payload:a}}function s(a){return{type:f.ky,payload:a}}function t(a){return{type:f.Yj,payload:a}}function u(a){return{type:f.wo,payload:a}}function v(a){return{type:f.VS,payload:a}}function w(){return{type:f.BZ,payload:null}}function x(a,b,c){return k(e().mark(function d(g){var h,j,k;return e().wrap(function(d){for(;;)switch(d.prev=d.next){case 0:return d.t0=l,d.next=3,i.V.put("".concat("https://planning.wedding","/api/v1/project/").concat(a,"/checklist/replace"),b);case 3:if(d.t1=d.sent,j=(h=(0,d.t0)(d.t1,2))[0],k=h[1],!j){d.next=10;break}return m(g,j.errors),d.abrupt("return");case 10:g({type:f.E1,payload:k.items}),c&&c(k.items);case 12:case"end":return d.stop()}},d)}))}function y(a){return{type:f.E1,payload:a}}function z(a,b,c){return function(d){h.c.getFile("POST","".concat("https://planning.wedding","/api/v1/export/project/").concat(a,"/checklist/pdf"),b,function(a){c&&c()},function(){c&&c()},b&&b.filename?b.filename:"checklist.pdf")}}function A(a,b,c){return function(d){h.c.getFile("POST","".concat("https://planning.wedding","/api/v1/export/project/").concat(a,"/checklist/xls"),b,function(a){c&&c()},function(){c&&c()},b&&b.filename?b.filename:"checklist.xls","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet")}}},28719:function(a,b,c){"use strict";var d=c(85893),e=c(67294);b.Z=(0,e.memo)(function(a){var b=a.title,c=a.small,f=a.handleExport,g=(0,e.useState)(!1),h=g[0],i=g[1];return(0,d.jsx)("button",{className:"app__download_xls"+(c?" app__download_xls_small":"")+(h?" app__generate-loading":""),onClick:function(){if(!h){var a=function(){i(!1)};i(!0),f(a)}},children:b||"Download XLS file"})},function(a,b){return b.title===a.title&&b.small===a.small&&b.handleExport===a.handleExport})},27667:function(a,b,c){"use strict";var d=c(85893),e=c(67294),f=c(65732),g=c(53766),h=c(83373),i=c(5582),j=c.n(i),k=c(30071),l=c(65801);b.Z=(0,e.memo)(function(a){var b=function(a){t(a)},c=a.locale,i=a.title,m=a.placeholder,n=a.date,o=a.handleUpdate,p=new Date(new Date().setFullYear(new Date().getFullYear()-5)),q=new Date(new Date().setFullYear(new Date().getFullYear()+3)),r=(0,e.useState)(!1),s=r[0],t=r[1];return(0,d.jsxs)("div",{className:"checklist__wedding-date text-center",children:[i,":","\xa0",(0,d.jsxs)(f.J2,{position:g.Ly.BOTTOM,isOpen:s,hasBackdrop:!0,canEscapeKeyClose:!0,onInteraction:function(a){return!1===a&& !0===s?b(!s):null},children:[(0,d.jsx)("span",{className:"psedo-link",onClick:function(){return b(!s)},children:n?j()(n).utc().format("dddd DD MMM YYYY"):m}),(0,d.jsx)(h.M,{value:n?l.o.removeTimeZone(n):new Date(),onChange:function(a){o(l.o.convertToUtcString(a))},maxDate:q,minDate:p,locale:c,localeUtils:k.default,canClearSelection:!1})]})]})},function(a,b){return b.locale===a.locale&&b.title===a.title&&b.placeholder===a.placeholder&&b.date===a.date})},76313:function(a,b,c){"use strict";c.r(b),c.d(b,{"__N_SSP":function(){return ka},"default":function(){return la}});var d=c(85893),e=c(67294),f=c(11163),g=c(70457),h=c(27208),i=c(14890),j=c(66338),k=c(59717),l=c(79953),m=c(71404),n=c(65732),o=c(53766),p=c(2609),q=c(73572),r=c(30834),s=c(15948),t=c(27667),u=c(1775),v=c.n(u),w=c(94184),x=c.n(w);function y(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function z(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}function A(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function B(a){return(B=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}function C(a,b){return(C=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a})(a,b)}var D=function(a){"use strict";!function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&C(a,b)}(h,a);var b,c,f,g=function(a){var b=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}();return function(){var c,d,e,f,g=B(a);if(b){var h=B(this).constructor;f=Reflect.construct(g,arguments,h)}else f=g.apply(this,arguments);return d=this,(e=f)&&("object"==((c=e)&&"undefined"!=typeof Symbol&&c.constructor===Symbol?"symbol":typeof c)||"function"==typeof e)?e:y(d)}}(h);function h(a){var b;return!function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(this,h),A(y(b=g.call(this,a)),"handleDelete",function(){b.props.handleDeleteSubTask(b.props.data.guid)}),A(y(b),"handleEdit",function(){b.setState({isEdit:!0})}),A(y(b),"handleEditingDone",function(){b.setState({isEdit:!1})}),A(y(b),"handleResolveSubTask",function(){b.setState({isEdit:!1}),b.props.handleUpdateSubTask(b.props.data.guid,!b.props.data.done)}),A(y(b),"handleChangeTitle",function(a){b.props.handleEditSubTask(b.props.data.guid,a)}),A(y(b),"renderCommon",function(a,c,f){return(0,d.jsxs)(e.Fragment,{children:[(0,d.jsx)("h3",{className:x()("checklist__subtask-h3",{"checklist__task-done":!!c}),onClick:b.handleResolveSubTask,children:a}),(0,d.jsxs)(n.J2,{interactionKind:n.V3.CLICK,popoverClassName:"checklist__subtask-popover",position:f?o.Ly.LEFT:o.Ly.BOTTOM_RIGHT,usePortal:!1,minimal:!0,children:[(0,d.jsx)("button",{className:"bp3-button bp3-minimal checklist__subtask-edit",children:(0,d.jsx)("span",{className:"bp3-icon bp3-icon-more checklist__subtask-edit-icon"})}),(0,d.jsxs)("div",{children:[(0,d.jsx)("button",{className:"bp3-button bp3-minimal bp3-fill bp3-popover-dismiss",onClick:b.handleEdit,children:b.props.intl("edit")}),(0,d.jsx)("button",{className:"bp3-button bp3-minimal bp3-intent-danger bp3-popover-dismiss bp3-fill",onClick:b.handleDelete,children:b.props.intl("delete")})]})]})]})}),A(y(b),"renderEditing",function(a){return(0,d.jsxs)(e.Fragment,{children:[(0,d.jsx)("h3",{className:"checklist__subtask-h3",children:(0,d.jsx)(n.sL,{multiline:!0,placeholder:b.props.intl("edit_placeholder"),value:a,onChange:b.handleChangeTitle,minLines:1,maxLines:12})}),(0,d.jsx)("button",{className:"bp3-button bp3-minimal checklist__subtask-edit",onClick:b.handleEditingDone,children:(0,d.jsx)("span",{className:"bp3-icon bp3-icon-edit"})})]})}),b.state={isEdit:!1},b}return b=h,c=[{key:"render",value:function(){var a=this.props.data,b=a.title,c=a.done,e=this.state.isEdit;return(0,d.jsxs)("div",{className:"checklist__subtask",children:[(0,d.jsx)("div",{className:"checklist__main-task-checkbox",onClick:this.handleResolveSubTask,children:(0,d.jsx)("div",{className:x()(c?"checklist__subtask-checkbox-element_done":"checklist__subtask-checkbox-element")})}),e?this.renderEditing(b):this.renderCommon(b,c,this.props.isLast)]})}}],z(b.prototype,c),f&&z(b,f),h}(e.Component),E=c(27832),F=c(5582),G=c.n(F);function H(a){if(void 0===a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return a}function I(a,b){for(var c=0;c<b.length;c++){var d=b[c];d.enumerable=d.enumerable||!1,d.configurable=!0,"value"in d&&(d.writable=!0),Object.defineProperty(a,d.key,d)}}function J(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function K(a){return(K=Object.setPrototypeOf?Object.getPrototypeOf:function(a){return a.__proto__||Object.getPrototypeOf(a)})(a)}function L(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{},d=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(d=d.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),d.forEach(function(b){J(a,b,c[b])})}return a}function M(a,b){return(M=Object.setPrototypeOf||function(a,b){return a.__proto__=b,a})(a,b)}var N=function(a){"use strict";!function(a,b){if("function"!=typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),b&&M(a,b)}(h,a);var b,c,f,g=function(a){var b=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(a){return!1}}();return function(){var c,d,e,f,g=K(a);if(b){var h=K(this).constructor;f=Reflect.construct(g,arguments,h)}else f=g.apply(this,arguments);return d=this,(e=f)&&("object"==((c=e)&&"undefined"!=typeof Symbol&&c.constructor===Symbol?"symbol":typeof c)||"function"==typeof e)?e:H(d)}}(h);function h(a){var b;return!function(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}(this,h),J(H(b=g.call(this,a)),"getItemStyle",function(a,b){return L({userSelect:"none",background:a?"#906cb4":"transparent",marginBottom:a?0:10,borderRadius:8},b)}),J(H(b),"shouldComponentUpdate",function(a,c){return a.connectionsCount>=2|| !!b.state.isOpen||v()(H(b),a,c)}),J(H(b),"handleChangeState",function(a,c){return b.setState(J({},a,c))}),J(H(b),"handleToggleTask",function(a){var c=a.target.className;if(-1===c.indexOf("edit")&& -1===c.indexOf("dismiss")){var d=!b.state.isOpen,e=!1!==d&&b.state.isEditTask,f=!1!==d&&b.state.isEditDescription;b.setState({isOpen:d,isEditTask:e,isEditDescription:f})}}),J(H(b),"handleOpenTask",function(){b.setState({isOpen:!0,isEditTask:!0,isEditDescription:!0})}),J(H(b),"handleChangeTitle",function(a){b.props.handleUpdateTask({guid:b.props.data.guid,title:a})}),J(H(b),"handleChangeDescription",function(a){b.props.handleUpdateTask({guid:b.props.data.guid,description:a})}),J(H(b),"handleDeleteTask",function(){b.props.handleDeleteTask(b.props.data.guid)}),J(H(b),"handleUpdateTask",function(a,c){var d=Array.from(b.props.data.subtasks);return d.map(function(a){return a.done=c,a}),b.props.handleUpdateTask({guid:b.props.data.guid,done:c,subtasks:d}),a.preventDefault(),a.stopPropagation(),!1}),J(H(b),"handleUpdateSubTask",function(a,c){var d=b.props.data.subtasks.length,e=Array.from(b.props.data.subtasks).filter(function(a){return!0===a.done}),f=Array.from(b.props.data.subtasks);b.props.handleUpdateSubTask({parentId:b.props.data.guid,data:{guid:a,done:c}}),(f=(f=f.map(function(b){return b.guid===a&&(b.done=c),b})).filter(function(a){return!0===a.done})).length===d?b.props.handleUpdateTask({guid:b.props.data.guid,done:!0}):e.length===d&&f.length===d-1&&b.props.handleUpdateTask({guid:b.props.data.guid,done:!1})}),J(H(b),"handleCreateSubTask",function(){var a=E.c.guid();b.props.handleCreateSubTask({parentId:b.props.data.guid,data:{guid:a,title:"",done:!1}}),setTimeout(function(){b[a]&&b[a].handleEdit()},20)}),J(H(b),"handleEditSubTask",function(a,c){b.props.handleUpdateSubTask({parentId:b.props.data.guid,data:{guid:a,title:c}})}),J(H(b),"handleDeleteSubTask",function(a){b.props.handleDeleteSubTask({parentId:b.props.data.guid,childId:a})}),J(H(b),"handleChangeMenuMode",function(a,c){b.setState({isMoveActive:c}),a.stopPropagation()}),J(H(b),"handleMoveTask",function(a){b.props.handleUpdateTask({guid:b.props.data.guid,period:a})}),J(H(b),"renderDescriptionEdit",function(a){return(0,d.jsxs)("div",{className:"checklist__subtasks-description",children:[(0,d.jsx)("div",{className:"checklist__subtasks-p",children:(0,d.jsx)(n.sL,{multiline:!0,placeholder:b.props.intl("edit_placeholder"),value:a,onChange:b.handleChangeDescription,minLines:1,maxLines:12})}),(0,d.jsx)("div",{className:"checklist__subtasks-description-edit",children:(0,d.jsx)("button",{className:"bp3-button bp3-minimal checklist__subtask-edit",onClick:function(){return b.handleChangeState("isEditDescription",!1)},children:(0,d.jsx)("span",{className:"bp3-icon bp3-icon-edit"})})})]})}),J(H(b),"renderDescriptionCommon",function(a){return(0,d.jsxs)("div",{className:"checklist__subtasks-description",children:[(0,d.jsx)("p",{className:"checklist__subtasks-p",children:a}),(0,d.jsx)("div",{className:"checklist__subtasks-description-edit",children:(0,d.jsxs)(n.J2,{interactionKind:n.V3.CLICK,popoverClassName:"checklist__subtask-popover",position:o.Ly.BOTTOM_RIGHT,usePortal:!1,minimal:!0,children:[(0,d.jsx)("button",{className:"bp3-button bp3-minimal checklist__subtask-edit",children:(0,d.jsx)("span",{className:"bp3-icon bp3-icon-more checklist__subtask-edit-icon"})}),(0,d.jsx)("div",{children:(0,d.jsx)("button",{className:"bp3-button bp3-minimal bp3-fill bp3-popover-dismiss",onClick:function(){return b.handleChangeState("isEditDescription",!0)},children:b.props.intl("edit")})})]})})]})}),J(H(b),"renderFull",function(a,c){var e=a?a.map(function(c,e){return(0,d.jsx)(D,{intl:b.props.intl,data:c,isLast:e===a.length-1,handleUpdateSubTask:b.handleUpdateSubTask,handleEditSubTask:b.handleEditSubTask,handleDeleteSubTask:b.handleDeleteSubTask,ref:function(a){return b[c.guid]=a}},e)}):null;return(0,d.jsxs)("div",{className:"checklist__subtasks",children:[b.state.isEditDescription?b.renderDescriptionEdit(c):b.renderDescriptionCommon(c),a&&a.length>0&&(0,d.jsx)("div",{className:"checklist__subtasks-title",children:b.props.intl("subtasks")}),e,(0,d.jsx)("div",{className:"text-right",children:(0,d.jsxs)("div",{className:"checklist__add-subtask",onClick:b.handleCreateSubTask,children:[(0,d.jsx)("span",{className:"bp3-icon bp3-icon-add"}),"\xa0",b.props.intl("subtasks_add_btn")]})})]})}),J(H(b),"renderTaskEdit",function(a){return(0,d.jsxs)(e.Fragment,{children:[(0,d.jsx)("h2",{className:"checklist__main-task-h2",children:(0,d.jsx)(n.sL,{multiline:!0,placeholder:b.props.intl("edit_placeholder"),value:a,onChange:b.handleChangeTitle,minLines:1,maxLines:12})}),b.state.isOpen&&(0,d.jsx)("div",{className:"checklist__task-edit",children:(0,d.jsx)("button",{className:"bp3-button bp3-minimal checklist__subtask-edit",onClick:function(){return b.handleChangeState("isEditTask",!1)},children:(0,d.jsx)("span",{className:"bp3-icon bp3-icon-edit"})})})]})}),J(H(b),"getDateByPeriod",function(a,b){return a.subtract(b,"month").format("MMM YYYY")}),J(H(b),"prepareWeddingPeriod",function(a,c){var d=b.props.intl,e=null;switch(a&&(e=G()(a)),parseFloat(c)){case 1:return d("period_1_month_to_go");case 0.5:return d("period_2_week_to_go");case 0.25:return d("period_1_week_to_go");case 0:return d("period_wedding_day");case -1:return d("period_after");default:return a?b.getDateByPeriod(e,parseFloat(c)):c+" "+d("period_months_to_go")}}),J(H(b),"renderMoveMenu",function(){var a=b.props,c=a.intl,e=a.weddingDate,f=a.weddingCreatedAt;return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("button",{className:"bp3-button bp3-minimal bp3-fill",onClick:function(a){return b.handleChangeMenuMode(a,!1)},children:c("back")}),(0,d.jsx)("hr",{style:{margin:5}}),b.renderGetAllList(e,f)]})}),J(H(b),"renderRegularMenu",function(){var a=b.props.intl;return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("button",{className:"bp3-button bp3-minimal bp3-fill",onClick:function(a){return b.handleChangeMenuMode(a,!0)},children:a("move")}),(0,d.jsx)("button",{className:"bp3-button bp3-minimal bp3-fill bp3-popover-dismiss",onClick:function(){return b.handleChangeState("isEditTask",!0)},children:a("edit")}),(0,d.jsx)("button",{className:"bp3-button bp3-minimal bp3-intent-danger bp3-popover-dismiss bp3-fill",onClick:b.handleDeleteTask,children:a("delete")})]})}),J(H(b),"renderTaskCommon",function(a,c){return(0,d.jsxs)(e.Fragment,{children:[(0,d.jsx)("h2",{className:x()("checklist__main-task-h2",{"checklist__task-done":!!a}),children:c}),b.state.isOpen&&(0,d.jsxs)(n.J2,{interactionKind:n.V3.CLICK,popoverClassName:"checklist__subtask-popover",position:o.Ly.BOTTOM_RIGHT,usePortal:!0,minimal:!0,children:[(0,d.jsx)("div",{className:"checklist__task-edit",children:(0,d.jsx)("button",{className:"bp3-button bp3-minimal checklist__subtask-edit",children:(0,d.jsx)("span",{className:"bp3-icon bp3-icon-more checklist__subtask-edit-icon"})})}),(0,d.jsx)("div",{children:b.state.isMoveActive?b.renderMoveMenu():b.renderRegularMenu()})]})]})}),b.state={isOpen:!1,isEditTask:!1,isEditDescription:!1,isMoveActive:!1},b}return b=h,c=[{key:"renderGetAllList",value:function(a,b){for(var c=this,f=function(b){var e=c;h.push((0,d.jsx)("button",{className:"bp3-button bp3-minimal bp3-fill bp3-popover-dismiss",onClick:function(){return e.handleMoveTask(b)},children:c.prepareWeddingPeriod(a,b)},b))},g=this,h=[],i=a?G()(a).diff(b?G()(b):new Date(),"months"):12,j=i;j>=1;j--)f(j);return(0,d.jsxs)(e.Fragment,{children:[h,(0,d.jsx)("button",{className:"bp3-button bp3-minimal bp3-fill bp3-popover-dismiss",onClick:function(){return g.handleMoveTask(0.25)},children:this.prepareWeddingPeriod(a,0.25)}),(0,d.jsx)("button",{className:"bp3-button bp3-minimal bp3-fill bp3-popover-dismiss",onClick:function(){return g.handleMoveTask(0)},children:this.prepareWeddingPeriod(a,0)}),(0,d.jsx)("button",{className:"bp3-button bp3-minimal bp3-fill bp3-popover-dismiss",onClick:function(){return g.handleMoveTask(-1)},children:this.prepareWeddingPeriod(a,-1)})]})}},{key:"render",value:function(){var a=this,b=this.props.data,c=b.guid,f=b.title,g=b.subtasks,h=b.description,i=b.done,j=0;g&&Array.isArray(g)&&g.forEach(function(a){!0===a.done&&(j+=1)});var k=j/(g.length?g.length/100:0);return k||(k=0),(0,d.jsx)(s._l,{draggableId:c,index:this.props.index,type:"GROUP",isDragDisabled:this.state.isOpen,children:function(b,l){return(0,d.jsx)(e.Fragment,{children:(0,d.jsx)("div",L({className:"checklist__drag-item",ref:b.innerRef},b.draggableProps,b.dragHandleProps,{style:a.getItemStyle(l.isDragging,b.draggableProps.style),children:(0,d.jsxs)("div",{className:x()("checklist__task",{checklist__task__done:i}),children:[(0,d.jsxs)("div",{className:"checklist__main-task",onClick:a.handleToggleTask,children:[(0,d.jsx)("div",{className:x()("checklist__main-task-progress",{"checklist__main-task-progress__done":i}),style:{width:"".concat(k,"%")}}),(0,d.jsx)("div",{className:"checklist__main-task-checkbox",onClick:function(b){return a.handleUpdateTask(b,!i)},children:(0,d.jsx)("div",{className:x()(i?"checklist__task-checkbox-element_done":"checklist__task-checkbox-element")})}),a.state.isEditTask?a.renderTaskEdit(f):a.renderTaskCommon(i,f),(0,d.jsxs)("div",{className:"checklist__main-task-counter",children:[j,"/",g&&Array.isArray(g)?g.length:0]}),(0,d.jsx)("div",{className:"checklist__main-task-arrow",children:(0,d.jsx)("span",{className:a.state.isOpen?"bp3-icon bp3-icon-chevron-down":"bp3-icon bp3-icon-chevron-right"})})]}),a.state.isOpen&&a.renderFull(g,h)]})}),c)})}},c)}}],I(b.prototype,c),f&&I(b,f),h}(e.Component),O=c(20569),P=c(28719),Q=c(68110),R=c(35196),S=c(66912),T=c(54956),U=c(73723),V=(0,e.forwardRef)(function(a,b){var c,f=function(){o(!m)},g=function(){o(!0)},h=function(a){k(a),f()},i=a.tChecklist,j=a.handleResetChecklist,k=a.handleReplaceChecklist,l=(0,e.useState)(!1),m=l[0],o=l[1];return((0,e.useImperativeHandle)(b,function(){return{show:g}}),m)?(0,d.jsxs)(n.Vq,{isOpen:m,onClose:f,className:"budget__dialog-currency",children:[(0,d.jsxs)("div",{className:"bp3-dialog-header",children:[(0,d.jsx)("h4",{className:"bp3-heading",children:i("settings")}),(0,d.jsx)("button",{onClick:f,className:"bp3-button bp3-minimal bp3-icon-cross"})]}),(0,d.jsx)("div",{className:"bp3-dialog-body bootstrap-wrapper",children:(c=U.l.activeList.map(function(a){var b=a.key,c=a.value;return(0,d.jsx)("span",{style:{display:"inline-block",marginBottom:20,marginRight:20},children:(0,d.jsx)("a",{onClick:function(a){return h(b)},children:c})},b)}),(0,d.jsxs)("div",{children:[(0,d.jsx)("button",{className:"bp3-button",onClick:function(){j(),f()},children:i("remove_all_task")}),(0,d.jsx)("br",{}),(0,d.jsx)("br",{}),(0,d.jsx)("p",{className:"wa-p",children:i("use_template")}),(0,d.jsx)("p",{className:"wa-p",children:i("choose_template")}),c]}))})]}):null}),W=c(91620);function X(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function Y(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{},d=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(d=d.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),d.forEach(function(b){X(a,b,c[b])})}return a}var Z=S.S.extract("templates/app").t,$=S.S.extract("project/check-list").t,_=S.S.extract("").t,aa={},ba={},ca={},da={},ea=null,fa=null,ga=null,ha=null,ia=null,ja=null,ka=!0,la=(0,j.$j)(function(a){return{user:a.user,wedding:a.wedding,checklist:a.checklist,connections:a.connections}},function(a){return{weddingActions:(0,i.DE)(k,a),checklistActions:(0,i.DE)(l,a)}})(function(a){var b=function(){var a=qa.changeOrderItemsTaskInstant,b=qa.createTaskInstant,c=qa.updateTaskInstant,d=qa.deleteTaskInstant,e=qa.createSubTaskInstant,f=qa.updateSubTaskInstant,g=qa.deleteSubTaskInstant,h=qa.resetTasksInstant,i=qa.replaceChecklistInstant;la.setCallBackEvents({changeOrderItemsTaskInstant:a,createTaskInstant:b,updateTaskInstant:c,deleteTaskInstant:d,createSubTaskInstant:e,updateSubTaskInstant:f,deleteSubTaskInstant:g,resetTasksInstant:h,replaceChecklistInstant:i})},c=function(a){if("full"!==ma.access)return null;if(a.destination){var b,c=parseInt(da[a.destination.index],10);b={from:a.source.droppableId,to:a.destination.droppableId,id:a.draggableId,index:c},qa.changeOrderItemsTaskInstant(b),la.send({action:"changeOrderItemsTaskInstant",payload:b}),j()}},i=function(a){if("full"!==ma.access)return null;pa.updateWedding(M,a,null,null,!0),pa.updateWeddingInstant(a),la.send({action:"updateWeddingInstant",payload:a})},j=function(){Sa(!0)},k=function(a){if("full"!==ma.access)return null;var b=E.c.guid(),c={guid:b,title:$("default_title"),description:$("default_description"),date:"",period:a,done:!1,subtasks:[],category:"Custom"};qa.createTaskInstant(c),la.send({action:"createTaskInstant",payload:c}),j(),Pa(!1),setTimeout(function(){ca[b].handleOpenTask();try{ba[a].scrollIntoView({behavior:"smooth",block:"center"})}catch(c){console.log(c)}},30)},l=function(a){if("full"!==ma.access)return null;qa.updateTaskInstant(a),la.send({action:"updateTaskInstant",payload:a}),j()},u=function(a){if("full"!==ma.access)return null;new Promise(function(a,b){ia=a,ja=b,Ga(!0)}).then(function(){Ga(!1),qa.deleteTaskInstant(a),la.send({action:"deleteTaskInstant",payload:a}),j()},function(){Ga(!1)})},v=function(a){if("full"!==ma.access)return null;qa.createSubTaskInstant(a),la.send({action:"createSubTaskInstant",payload:a}),j()},w=function(a){if("full"!==ma.access)return null;qa.updateSubTaskInstant(a),la.send({action:"updateSubTaskInstant",payload:a}),j()},x=function(a){if("full"!==ma.access)return null;qa.deleteSubTaskInstant(a),la.send({action:"deleteSubTaskInstant",payload:a}),j()},y=function(){if("full"!==ma.access)return null;new Promise(function(a,b){ea=a,fa=b,Ma(!0)}).then(function(){Ma(!1),qa.resetTasksInstant(),la.send({action:"resetTasksInstant",payload:{}}),j()},function(){Ma(!1)})},z=function(a){if("full"!==ma.access)return null;new Promise(function(a,b){ga=a,ha=b,Ja(!0)}).then(function(){Ja(!1);var b={locale:a};qa.replaceChecklist(M,b,function(a){la.send({action:"replaceChecklistInstant",payload:a})})},function(){Ja(!1)})},A=function(a,b,c){var d=a&&b?"".concat(a.replace(/ /g,"_"),"_&_").concat(b.replace(/ /g,"_"),"_"):"";return"".concat(d,"checklist_").concat(G()().format("DD-MMMM-YYYY"),".").concat(c)},B=function(b){var c=ma.guid,d=ma.groom,e=ma.bride,f={wli:a.user.wli,filename:A(d,e,"pdf")};qa.getPdf(c,f,b),m.B({category:"Project",action:"project-export-checklist-pdf",label:"Project Export Checklist Pdf"})},C=function(b){var c=ma.guid,d=ma.groom,e=ma.bride,f={wli:a.user.wli,filename:A(d,e,"xls")};qa.getXls(c,f,b),m.B({category:"Project",action:"project-export-checklist-xls",label:"Project Export Checklist Xls"})},D=function(a,b){var c,d,e=null;switch(a&&(e=G()(a)),parseFloat(b)){case 1:return $("period_1_month_to_go");case 0.5:return $("period_2_week_to_go");case 0.25:return $("period_1_week_to_go");case 0.01:return $("period_1_day_to_go");case 0:return $("period_wedding_day");case -1:return $("period_after");default:return a?(c=e,d=parseFloat(b),c.subtract(d,"month").format("MMM YYYY")):b+" "+$("period_months_to_go")}},F=function(){Pa(!Oa)},H=function(){ka&&ka.current&&ka.current.show()},I=function(a){for(var b=function(b){c.push((0,d.jsx)("button",{className:"bp3-button bp3-minimal bp3-fill bp3-popover-dismiss",onClick:function(){return k(b)},children:D(a,b)},b))},c=[],f=a?G()(a).diff(ma.created_at?G()(ma.created_at):new Date(),"months"):12,g=f;g>=1;g--)b(g);return(0,d.jsxs)(e.Fragment,{children:[c,(0,d.jsx)("button",{className:"bp3-button bp3-minimal bp3-fill bp3-popover-dismiss",onClick:function(){return k(0.25)},children:D(a,0.25)}),(0,d.jsx)("button",{className:"bp3-button bp3-minimal bp3-fill bp3-popover-dismiss",onClick:function(){return k(0.01)},children:D(a,0.01)}),(0,d.jsx)("button",{className:"bp3-button bp3-minimal bp3-fill bp3-popover-dismiss",onClick:function(){return k(0)},children:D(a,0)}),(0,d.jsx)("button",{className:"bp3-button bp3-minimal bp3-fill bp3-popover-dismiss",onClick:function(){return k(-1)},children:D(a,-1)})]})},J=function(a,b){return(0,d.jsxs)(n.J2,{interactionKind:n.V3.CLICK,popoverClassName:"checklist__subtask-popover",position:o.Ly.BOTTOM_RIGHT,usePortal:!1,minimal:!0,children:[(0,d.jsx)("button",{className:"bp3-button bp3-minimal bp3-icon-plus wa-intent-purple",children:$("add_task_btn")}),(0,d.jsxs)("div",{children:[(0,d.jsx)("button",{className:"bp3-button bp3-minimal bp3-fill bp3-popover-dismiss",onClick:function(){return k(b)},children:D(a,b)}),(0,d.jsx)("hr",{style:{margin:5}}),Oa?I(a):(0,d.jsx)("button",{className:"bp3-button bp3-minimal bp3-fill",onClick:function(){return F(b)},children:$("show_all_btn")})]})]})},K=(0,f.useRouter)(),L=K.locale,M=K.query.weddingGuid,U=(0,e.useRef)(null);L!==U.current&&(S.S.load(L,a.dict),U.current=L);var X=(0,e.useRef)(),ka=(0,e.useRef)(),la=(X&&X.current?X.current:{}).socket,ma=a.wedding,na=a.checklist,oa=a.connections,pa=a.weddingActions,qa=a.checklistActions,ra=(0,e.useState)(0),sa=ra[0],ta=ra[1],ua=(0,e.useState)(!1),va=ua[0];ua[1];var wa,xa,ya,za,Aa,Ba,Ca,Da,Ea=(0,e.useState)(!1),Fa=Ea[0],Ga=Ea[1],Ha=(0,e.useState)(!1),Ia=Ha[0],Ja=Ha[1],Ka=(0,e.useState)(!1),La=Ka[0],Ma=Ka[1],Na=(0,e.useState)(!1),Oa=Na[0],Pa=Na[1],Qa=(0,e.useState)(!1),Ra=Qa[0],Sa=Qa[1],Ta=T.G.isEvent(ma.project_type);return(0,g.C)(function(){M&&"[weddingGuid]"!==M&&qa.getChecklist(M)},[M]),(0,h.D)(function(){ta(sa+1)},[L]),(0,e.useEffect)(function(){return la&&b(la),function(){la&&la.setCallBackEvents({})}},[la]),(0,e.useEffect)(function(){Ra&&(clearInterval(aa),aa=setTimeout(function(){na.list&&qa.updateChecklist(M,{list:na.list},null,!0)},500),Sa(!1))},[Ra]),(0,d.jsxs)(q.Z,{ref:X,children:[(wa=(0,R.R)("/project/".concat(M,"/checklist"),L),(0,d.jsx)(r.Z,{router:K,title:$("h2"),description:$("p"),alternate:"all",disableIndexing:"none",canonical:wa,schemaLogo:JSON.stringify([W.c.generate(L)])})),(0,d.jsxs)("main",{className:"app__container",children:[(0,d.jsx)("h1",{className:"wa-h2",children:$("h2")}),(0,d.jsx)("p",{className:"wa-p",children:$("p")}),ma._id&&na.list?(xa=ma.ceremony_date,ya=ma.created_at,za=na.list,Aa={},za&&Array.isArray(za)&&za.forEach(function(a,b){Aa[a.period]?Aa[a.period].push(Y({},a,{solidIndex:b})):Aa[a.period]=[Y({},a,{solidIndex:b})]}),Ba=Object.entries(Aa),Ba.sort(function(a,b){return parseFloat(b[0])-parseFloat(a[0])}),da={},Ca=-1,Da=Ba.length,Ba=Ba.map(function(a,b){var c=a[1].map(function(b){return da[Ca+=1]=b.solidIndex,(0,d.jsx)(N,{intl:$,weddingDate:xa,weddingCreatedAt:ya,data:b,index:Ca,solidIndex:b.solidIndex,connectionsCount:oa.count,handleUpdateTask:l,handleDeleteTask:u,handleCreateSubTask:v,handleUpdateSubTask:w,handleDeleteSubTask:x,ref:function(a){return ca[b.guid]=a}},b.guid+"_"+a[1])}),f=D(xa,a[0]);return(0,d.jsx)(e.Fragment,{children:(0,d.jsxs)("div",{className:"checklist__period"+(b!==Da-1?" checklist__period-separator":""),children:[(0,d.jsxs)("div",{className:"checklist__period-header",ref:function(b){return ba[a[0]]=b},children:[(0,d.jsx)("h1",{className:"checklist__date",children:f}),J(xa,a[0])]}),c]})},a[0])}),(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"checklist__container",children:[(0,d.jsx)("br",{}),(0,d.jsx)(t.Z,{locale:L,title:Z(Ta?"event_date":"wedding_date"),placeholder:Z(Ta?"set_event_date":"set_wedding_date"),date:xa,handleUpdateWedding:i,handleUpdate:function(a){i({ceremony_date:a})}}),(0,d.jsx)("div",{className:"text-right",style:{paddingRight:15},children:(0,d.jsx)("button",{className:"bp3-button bp3-minimal bp3-icon-cog wa-intent-purple",onClick:H,children:$("settings")})}),Ba.length?(0,d.jsx)("div",{className:"checklist__dragging-fix",children:(0,d.jsx)(s.Z5,{onDragStart:function(a){},onDragUpdate:function(){},onDragEnd:c,children:(0,d.jsx)(s.bK,{droppableId:"groups",type:"GROUPS",children:function(a,b){return(0,d.jsx)("div",{ref:a.innerRef,style:{outline:va?"2px dotted rgb(208, 189, 172)":"0px"},children:Ba})}})})}):(0,d.jsxs)(e.Fragment,{children:[(0,d.jsx)("br",{}),(0,d.jsx)("br",{}),(0,d.jsxs)("div",{className:"bp3-non-ideal-state",children:[(0,d.jsx)("div",{className:"bp3-non-ideal-state-visual",children:(0,d.jsx)("span",{className:"bp3-icon bp3-icon-delta"})}),(0,d.jsx)("h4",{className:"bp3-heading",children:$("non_ideal_state_h4")}),(0,d.jsx)("p",{children:$("non_ideal_state_p")}),J(ma.ceremony_date,0)]})]})]}),(0,d.jsx)("br",{}),"full"===ma.access&&Ba.length>0&&(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)(O.Z,{title:Z("download_pdf_btn"),handleExport:B}),(0,d.jsx)("br",{}),(0,d.jsx)(P.Z,{title:Z("download_xls_btn"),handleExport:C})]}),(0,d.jsx)("br",{}),(0,d.jsx)("br",{}),(0,d.jsx)(n.bZ,{intent:p.S.DANGER,isOpen:La,confirmButtonText:_("yes"),cancelButtonText:_("no"),onConfirm:ea,onCancel:fa||function(){},children:(0,d.jsx)("p",{children:$("reset_alert")})}),(0,d.jsx)(n.bZ,{intent:p.S.DANGER,isOpen:Ia,confirmButtonText:_("yes"),cancelButtonText:_("no"),onConfirm:ga,onCancel:ha||function(){},children:(0,d.jsx)("p",{children:$("replace_alert")})}),(0,d.jsx)(n.bZ,{intent:p.S.DANGER,isOpen:Fa,confirmButtonText:_("yes"),cancelButtonText:_("no"),onConfirm:ia,onCancel:ja||function(){},children:(0,d.jsx)("p",{children:$("remove_alert")})}),(0,d.jsx)(V,{tChecklist:$,handleResetChecklist:y,handleReplaceChecklist:z,ref:ka})]})):(0,d.jsx)(Q.Z,{})]})]})})},27208:function(a,b,c){"use strict";c.d(b,{D:function(){return e}});var d=c(67294);function e(a,b){var c=(0,d.useRef)(!1);(0,d.useEffect)(function(){c.current?a():c.current=!0},b)}},1775:function(a){"use strict";var b=Object.prototype.hasOwnProperty;function c(a,b){return a===b?0!==a||0!==b||1/a==1/b:a!=a&&b!=b}function d(a,d){if(c(a,d))return!0;if("object"!=typeof a||null===a||"object"!=typeof d||null===d)return!1;var e=Object.keys(a),f=Object.keys(d);if(e.length!==f.length)return!1;for(var g=0;g<e.length;g++)if(!b.call(d,e[g])||!c(a[e[g]],d[e[g]]))return!1;return!0}a.exports=function(a,b,c){return!d(a.props,b)||!d(a.state,c)}}},function(a){a.O(0,[4885,630,4317,4116,5732,4734,6441,5162,3458,5506,3524,7868,7811,6120,5154,3894,8262,1837,8470,6179,5083,42,1385,9774,2888,179],function(){return a(a.s=5593)}),_N_E=a.O()}])