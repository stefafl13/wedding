(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7645],{60393:function(a,b,c){(window.__NEXT_P=window.__NEXT_P||[]).push(["/project/[weddingGuid]/post-event",function(){return c(25690)}])},94029:function(a,b,c){"use strict";c.r(b),c.d(b,{pushToasts:function(){return l},getPostEvent:function(){return m},updatePostEventInstant:function(){return n},updatePostEvent:function(){return o},addPhotoPostEventInstant:function(){return p},addPhotoPostEvent:function(){return q},addPhotoByWebsiteGuidPostEvent:function(){return r},deletePhotosPostEvent:function(){return s},deletePhotosByWebsiteGuidPostEvent:function(){return t},deletePhotosPostEventInstant:function(){return u},setQueueUploadPostEvent:function(){return v},uploadPhotosPostEvent:function(){return w},downloadAllPhotos:function(){return x}});var d=c(35666),e=c.n(d),f=c(14955),g=c(88086),h=c(31624);function i(a,b,c,d,e,f,g){try{var h=a[f](g),i=h.value}catch(j){c(j);return}h.done?b(i):Promise.resolve(i).then(d,e)}function j(a){return function(){var b=this,c=arguments;return new Promise(function(d,e){var f=a.apply(b,c);function g(a){i(f,d,e,g,h,"next",a)}function h(a){i(f,d,e,g,h,"throw",a)}g(void 0)})}}function k(a,b){return(function(a){if(Array.isArray(a))return a})(a)||(function(a,b){var c=[],d=!0,e=!1,f=void 0;try{for(var g,h=a[Symbol.iterator]();!(d=(g=h.next()).done)&&(c.push(g.value),!b||c.length!==b);d=!0);}catch(i){e=!0,f=i}finally{try{d||null==h.return||h.return()}finally{if(e)throw f}}return c})(a,b)||(function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")})()}function l(a,b){a({type:g.I,payload:h.V.errorsForNotifications(h.V.extractErrors(b))})}function m(a){return j(e().mark(function b(c){var d,g,i;return e().wrap(function(b){for(;;)switch(b.prev=b.next){case 0:return c({type:f.Ij,payload:null}),b.t0=k,b.next=4,h.V.get("".concat("https://planning.wedding","/api/v1/project/").concat(a,"/post-event"),null);case 4:if(b.t1=b.sent,g=(d=(0,b.t0)(b.t1,2))[0],i=d[1],!g){b.next=11;break}return l(c,g.errors),b.abrupt("return");case 11:c({type:f.Ij,payload:i.item});case 12:case"end":return b.stop()}},b)}))}function n(a){return{type:f.Q5,payload:a}}function o(a,b,c){var d=void 0!==c&&c;return j(e().mark(function c(g){var i,j,m;return e().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.t0=k,c.next=3,h.V.put("".concat("https://planning.wedding","/api/v1/project/").concat(a,"/post-event"),b);case 3:if(c.t1=c.sent,j=(i=(0,c.t0)(c.t1,2))[0],m=i[1],!j){c.next=10;break}return l(g,j.errors),c.abrupt("return");case 10:d||g({type:f.Ij,payload:m.item});case 11:case"end":return c.stop()}},c)}))}function p(a){return{type:f.$u,payload:a}}function q(a,b,c){var d=void 0!==c&&c;return j(e().mark(function c(g){var i,j,m;return e().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.t0=k,c.next=3,h.V.post("".concat("https://planning.wedding","/api/v1/project/").concat(a,"/post-event/photo"),b);case 3:if(c.t1=c.sent,j=(i=(0,c.t0)(c.t1,2))[0],m=i[1],!j){c.next=10;break}return l(g,j.errors),c.abrupt("return");case 10:d||g({type:f.Ae,payload:m.item});case 11:case"end":return c.stop()}},c)}))}function r(a,b,c){var d=void 0!==c&&c;return j(e().mark(function c(g){var i,j,m;return e().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.t0=k,c.next=3,h.V.post("".concat("https://planning.wedding","/api/v1/wedding-website/").concat(a,"/post-event/photo"),b);case 3:if(c.t1=c.sent,j=(i=(0,c.t0)(c.t1,2))[0],m=i[1],!j){c.next=10;break}return l(g,j.errors),c.abrupt("return");case 10:d||g({type:f.Ae,payload:m.item});case 11:case"end":return c.stop()}},c)}))}function s(a,b,c){var d=void 0!==c&&c;return j(e().mark(function c(g){var i,j,m;return e().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.t0=k,c.next=3,h.V.delete("".concat("https://planning.wedding","/api/v1/project/").concat(a,"/post-event/photos"),b);case 3:if(c.t1=c.sent,j=(i=(0,c.t0)(c.t1,2))[0],m=i[1],!j){c.next=10;break}return l(g,j.errors),c.abrupt("return");case 10:d||g({type:f.Ae,payload:m.item});case 11:case"end":return c.stop()}},c)}))}function t(a,b,c){var d=void 0!==c&&c;return j(e().mark(function c(g){var i,j,m;return e().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return c.t0=k,c.next=3,h.V.delete("".concat("https://planning.wedding","/api/v1/wedding-website/").concat(a,"/post-event/photos"),b);case 3:if(c.t1=c.sent,j=(i=(0,c.t0)(c.t1,2))[0],m=i[1],!j){c.next=10;break}return l(g,j.errors),c.abrupt("return");case 10:d||g({type:f.Ae,payload:m.item});case 11:case"end":return c.stop()}},c)}))}function u(a){return{type:f._d,payload:a}}function v(a){return{type:f.kQ,payload:a}}function w(a,b,c,d){return j(e().mark(function f(g){var i,j,m;return e().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=k,e.next=3,h.V.post("".concat("https://planning.wedding","/api/v1/upload/image/w/").concat(a,"/").concat(b),c,{stringify:!1});case 3:if(e.t1=e.sent,j=(i=(0,e.t0)(e.t1,2))[0],m=i[1],!j){e.next=10;break}return l(g,j.errors),e.abrupt("return");case 10:d&&d(m.result);case 11:case"end":return e.stop()}},f)}))}function x(a,b){return j(e().mark(function c(d){var f,g,i;return e().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:return f={stringify:!0,fileName:"photos.zip",fileType:"application/zip"},c.t0=k,c.next=4,h.V.get("".concat("https://planning.wedding","/api/v1/project/").concat(a,"/post-event/photos/download"),null,f);case 4:if(c.t1=c.sent,!(i=(g=(0,c.t0)(c.t1,1))[0])){c.next=11;break}return i.errors&&l(d,i.errors),b&&b(),c.abrupt("return");case 11:b&&b();case 12:case"end":return c.stop()}},c)}))}},89597:function(a,b,c){"use strict";var d=c(85893),e=c(67294),f=c(55162),g=c(56441),h=c.n(g),i=c(71893),j=c.n(i);function k(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function l(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{},d=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(d=d.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),d.forEach(function(b){k(a,b,c[b])})}return a}b.Z=function(a){var b=function(a){var b=l({},n)[a].id,c=Array.from(u),d={};c.forEach(function(a){return d[a]=!0}),d[b]?delete d[b]:d[b]=!0,v(Object.keys(d))},c=function(a){r(a,u),v([])},g=function(a,b){var c=i||30;return(0,d.jsxs)("div",{className:"bp3-non-ideal-state",children:[(0,d.jsx)("br",{}),!(void 0!==b&&b)&&(0,d.jsxs)(e.Fragment,{children:[(0,d.jsx)("br",{}),(0,d.jsx)("br",{}),(0,d.jsx)("div",{className:"bp3-non-ideal-state-visual",children:(0,d.jsx)("span",{className:"bp3-icon bp3-icon-cloud-upload"})}),(0,d.jsx)("h4",{className:"bp3-heading",children:j().get("upload_photos").d("…")})]}),(0,d.jsx)("p",{className:"wa-p",children:j().get("upload_try").d("…")}),(0,d.jsxs)("p",{className:"wa-p",children:[(0,d.jsx)("b",{children:j().get("upload_limit_count",{limit:c}).d("…")}),"\xa0",a&&Array.isArray(a)&&a.length>0?(0,d.jsx)("b",{children:j().get("upload_more",{value:c-a.length}).d("…")}):null,(0,d.jsx)("br",{}),j().get("upload_limit_size",{size:(k||20)+"Mb"}).d("…")]}),(0,d.jsx)("button",{className:"bp3-button bp3-intent-purple",children:j().get("upload_btn").d("…")}),(0,d.jsx)("br",{})]})},i=a.countLimit,k=a.sizeLimit,m=a.isActive,n=a.photos,o=a.queue,p=a.enableImageSelection,q=a.handleOnDrop,r=a.handleDeleteImages,s=a.handleNotificationActions,t=(0,e.useState)([]),u=t[0],v=t[1],w=(0,e.useRef)(),x={};u.forEach(function(a){return x[a]=!0});var y=n&&Array.isArray(n)?n.map(function(a,b){return{nano:a.nano,src:a.normal.f,thumbnail:a.thumb360.f,thumbnailWidth:a.thumb360.w,thumbnailHeight:a.thumb360.h,isSelected:!!x[a.id]}}):[];return(0,d.jsx)(f.ZP,{accept:"image/jpeg, image/png, image/webp, image/heic, image/avif",onDrop:function(a){if(m){var b=i||30,c=a.length,d=b-((n&&Array.isArray(n)?n.length:0)+(o||0));c>d&&(a=a.filter(function(a,b){return b<d}),s.pushToasts([{message:j().get("upload_reached_limit",{count:b}).d("…")}])),q(a,k||20)}},children:function(a){var e,f,i=a.getRootProps,k=a.getInputProps;return(0,d.jsxs)("div",l({className:"post-event__dropzone"},i(),{children:[(0,d.jsx)("input",l({},k())),(0,d.jsxs)("div",{children:[(0,d.jsx)(h(),{images:y,backdropClosesModal:!0,enableImageSelection:p,onSelectImage:b,ref:w}),o?(e=o,(0,d.jsx)("div",{className:"photo-loading",children:(0,d.jsxs)("span",{className:"photo-loading__counter",children:["+",e]})})):null]}),(f=u,(0,d.jsx)("div",{className:"col-xs-12 text-center",children:f.length>0?(0,d.jsx)("button",{className:"bp3-button bp3-intent-danger",onClick:c,children:j().get("upload_delete_btn").d("…")}):null})),y.length>0?g(n,!0):g()]}))}})}},34318:function(a,b,c){"use strict";c.d(b,{Z:function(){return o}});var d=c(85893),e=c(67294),f=c(65732),g=c(15948);function h(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}function i(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{},d=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(d=d.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),d.forEach(function(b){h(a,b,c[b])})}return a}var j=function(a){var b=a.index,c=a.data,e=a.handleRemove,f=c.id,h=c.normal,j=h.w/(h.h/200);return(0,d.jsx)(g._l,{draggableId:f||b,index:b,type:"PHOTO",children:function(a,c){var g;return(0,d.jsx)("div",i({style:i({},(g=c.isDragging,a.draggableProps.style,i({userSelect:"none",background:g?"#FFF":"transparent"},g?{width:"100%",display:"block",borderRadius:4}:{},a.draggableProps.style)),{display:"flex"})},a.draggableProps,a.dragHandleProps,{ref:a.innerRef,children:(0,d.jsxs)("div",{style:{display:"flex",height:200,width:j,position:"relative"},children:[(0,d.jsx)("div",{style:{position:"absolute",top:-35,left:0,display:"flex",justifyContent:"center",alignItems:"center",width:35,height:35,background:"#9F7B92",fontWeight:"bold",color:"#FFF",marginRight:4},children:b+1}),(0,d.jsx)("div",{style:{pointerEvents:"none"},children:(0,d.jsx)("img",{style:{height:"100%",width:"auto"},src:h.f})}),(0,d.jsx)("button",{className:"bp3-button bp3-intent-danger bp3-minimal bp3-icon-trash",onClick:function(a){return e(a,f)},style:{position:"absolute",left:35,top:-35,width:35,height:35}})]})}),b)}})},k=c(71893),l=c.n(k);function m(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}var n=(0,e.forwardRef)(function(a,b){var c=function(){s(!r)},h=function(){s(!0)},i=function(a){},k=function(a){if(a.destination&&"photos"===a.type.toLowerCase()){var b=Array.from(n),c=b.splice(a.source.index,1);c&&c[0]&&b.splice(a.destination.index,0,c[0]),p(b)}},n=a.photos,o=a.handleRemove,p=a.handleChange,q=(0,e.useState)(!1),r=q[0],s=q[1];return((0,e.useImperativeHandle)(b,function(){return{show:h}}),r)?(0,d.jsxs)(f.Vq,{isOpen:r,onClose:c,style:{width:"90%"},children:[(0,d.jsxs)("div",{className:"bp3-dialog-header",children:[(0,d.jsx)("h4",{className:"bp3-heading",children:l().get("gallery.manage").d("…")}),(0,d.jsx)("button",{onClick:c,className:"bp3-button bp3-minimal bp3-icon-cross"})]}),(0,d.jsx)("div",{className:"bp3-dialog-body bootstrap-wrapper",children:function(){var a=n&&Array.isArray(n)?n.map(function(a,b){return(0,d.jsx)(j,{index:b,data:a,handleRemove:o},a.id)}):[];return(0,d.jsxs)(e.Fragment,{children:[(0,d.jsx)("p",{className:"wa-p text-center",children:l().get("gallery.drag").d("…")}),(0,d.jsx)(g.Z5,{onDragStart:i,onDragEnd:k,children:(0,d.jsx)(g.bK,{direction:"horizontal",droppableId:"PHOTOS",type:"PHOTOS",children:function(b,c){return(0,d.jsxs)("div",function(a){for(var b=1;b<arguments.length;b++){var c=null!=arguments[b]?arguments[b]:{},d=Object.keys(c);"function"==typeof Object.getOwnPropertySymbols&&(d=d.concat(Object.getOwnPropertySymbols(c).filter(function(a){return Object.getOwnPropertyDescriptor(c,a).enumerable}))),d.forEach(function(b){m(a,b,c[b])})}return a}({ref:b.innerRef,style:{display:"flex",padding:10,paddingTop:45,width:"100%",overflow:"auto"}},b.droppableProps,{children:[a,b.placeholder]}))}})})]})}()})]}):null}),o=function(a){var b=a.photos,c=a.children,f=a.handleRemove,g=a.handleChange,h=(0,e.useRef)();return(0,d.jsxs)(d.Fragment,{children:[b&&Array.isArray(b)&&b.length>0?(0,d.jsx)("div",{style:{marginTop:10,marginBottom:10},children:e.cloneElement(e.Children.only(c),{onClick:function(){h&&h.current&&h.current.show()}})}):null,(0,d.jsx)(n,{photos:b,handleRemove:f,handleChange:g,ref:h})]})}},25690:function(a,b,c){"use strict";c.r(b),c.d(b,{"__N_SSP":function(){return F},"default":function(){return G}});var d=c(85893),e=c(67294),f=c(11163),g=c(70457),h=c(14890),i=c(66338),j=c(32743),k=c(94029),l=c(73572),m=c(30834),n=c(68110),o=c(65732),p=c(89597),q=c(34318),r=(0,e.memo)(function(a){var b=a.title,c=a.small,f=a.handleExport,g=(0,e.useState)(!1),h=g[0],i=g[1];return(0,d.jsx)("button",{className:"app__download_zip"+(c?" app__download_zip_small":"")+(h?" app__generate-loading":""),onClick:function(){if(!h){var a=function(){i(!1)};i(!0),f(a)}},children:b||"Download ZIP file"})},function(a,b){return b.title===a.title&&b.small===a.small&&b.handleExport===a.handleExport}),s=c(35196),t=c(66912),u=c(71893),v=c.n(u),w=c(54956),x=c(91620),y=t.S.extract("project/post-event"),z=y.t,A=t.S.extract("templates/app"),B=A.t,C=t.S.extract(""),D=C.t,E={},F=!0,G=(0,i.$j)(function(a){return{wedding:a.wedding,postEvent:a.postEvent}},function(a){return{notificationActions:(0,h.DE)(j,a),postEventActions:(0,h.DE)(k,a)}})(function(a){var b=function(){var a=N.updatePostEventInstant,b=N.setQueueUploadPostEvent,c=N.addPhotoPostEventInstant,d=N.deletePhotosPostEventInstant;J.setCallBackEvents({updatePostEventInstant:a,setQueueUploadPostEvent:b,addPhotoPostEventInstant:c,deletePhotosPostEventInstant:d})},c=function(a,b){if("full"!==K.access)return null;N.deletePhotosPostEvent(j,{ids:b},!0),N.deletePhotosPostEventInstant(b),J.send({action:"deletePhotosPostEventInstant",payload:b}),a.preventDefault(),a.stopPropagation()},h=(0,f.useRouter)(),i=h.locale,j=h.query.weddingGuid,k=(0,e.useRef)(null);i!==k.current&&(t.S.load(i,a.dict),k.current=i);var u,y,A,C,F,G,H,I=(0,e.useRef)(),J=(I&&I.current?I.current:{}).socket,K=a.wedding,L=a.postEvent,M=a.notificationActions,N=a.postEventActions,O=w.G.isEvent(K.project_type),P=(0,e.useState)(300)[0],Q=(0,e.useState)(!1),R=Q[0],S=Q[1];return(0,g.C)(function(){j&&"[weddingGuid]"!==j&&N.getPostEvent(j)},[j]),(0,e.useEffect)(function(){return J&&b(J),function(){J&&J.setCallBackEvents({})}},[J]),(0,d.jsxs)(l.Z,{ref:I,children:[(u=(0,s.R)("/project/".concat(j,"/post-event"),i),(0,d.jsx)(m.Z,{router:h,title:z(O?"h1_event":"h1"),description:z("p"),alternate:"all",disableIndexing:"none",canonical:u,schemaLogo:JSON.stringify([x.c.generate(i)])})),(0,d.jsxs)("main",{className:"venue__container",children:[(0,d.jsx)("h1",{className:"wa-h2",children:z(O?"h1_event":"h1")}),(0,d.jsx)("p",{className:"wa-p text-center",children:z("p")}),K._id&&L.photos?(y=L.photos,(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("br",{}),(A=L.comment,(0,d.jsx)("div",{className:"venue__comment",children:(0,d.jsx)(o.sL,{className:"basic__comment",value:A||"",multiline:!0,minLines:3,maxLines:1000,onChange:function(a){if("full"!==K.access)return null;var b={comment:a};clearInterval(E),E=setTimeout(function(){N.updatePostEvent(j,b,!0)},P),N.updatePostEventInstant(b),J.send({action:"updatePostEventInstant",payload:b})},placeholder:D("upload_comment_placeholder")})})),(C=L.photos,F=L.queue,G=L.limit,(0,d.jsx)(p.Z,{photos:C,queue:F,countLimit:G,enableImageSelection:!1,isActive:"full"===K.access,handleOnDrop:function(a,b){if("full"!==K.access)return null;var c=N.uploadPhotosPostEvent,d=N.setQueueUploadPostEvent,e=N.addPhotoPostEventInstant,f=N.addPhotoPostEvent,g=0;a.forEach(function(a){var d=1048576*b;if(a.size>d)M.pushToasts([{message:D("upload_file_size_too_large",{size:b})}]);else{var h=new FormData();h.append("files",a),c(K._id,"post-event",h,function(a){f(j,{photo:a},!0),e(a),J.send({action:"addPhotoPostEventInstant",payload:a})}),g+=1}}),g>0&&(d(g),J.send({action:"setQueueUploadPostEvent",payload:g}))},handleDeleteImages:c,handleNotificationActions:M})),(H=L.photos,"full"===K.access?(0,d.jsx)(q.Z,{photos:H,handleRemove:function(a,b){return c(a,[b])},handleChange:function(a){if("full"!==K.access)return null;var b={photos:a};N.updatePostEvent(j,b,!0),N.updatePostEventInstant(b),J.send({action:"updatePostEventInstant",payload:b})},children:(0,d.jsx)("button",{className:"bp3-button wa-intent-light bp3-minimal bp3-icon-style bp3-large bp3-fill",children:v().get("gallery.manage").d("…")})}):null),y&&y.length>0?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("br",{}),(0,d.jsxs)("div",{className:"text-center",children:[(0,d.jsx)(r,{title:B("download_all_btn"),handleExport:function(a){N.downloadAllPhotos(j,function(){a(),S(!1)}),S(!0)}}),R?(0,d.jsx)("p",{className:"wa-p text-center",children:B("please_wait")}):null]})]}):null,(0,d.jsx)("br",{}),(0,d.jsx)("br",{}),(0,d.jsx)("br",{})]})):(0,d.jsx)(n.Z,{})]})]})})}},function(a){a.O(0,[4885,630,4317,4116,5732,4734,6441,5162,3458,5506,3524,7868,7811,6120,5154,3894,8262,1837,8470,6179,5083,42,1385,9774,2888,179],function(){return a(a.s=60393)}),_N_E=a.O()}])